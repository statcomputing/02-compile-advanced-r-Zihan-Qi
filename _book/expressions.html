<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>18 Expressions | Advanced R</title>
  <meta name="description" content="The book is designed primarily for R users who want to improve their programming skills and understanding of the language. It should also be useful for programmers coming to R from other languages, as help you to understand why R works the way it does." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="18 Expressions | Advanced R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://adv-r.hadley.nz/" />
  <meta property="og:image" content="https://adv-r.hadley.nz/cover.png" />
  <meta property="og:description" content="The book is designed primarily for R users who want to improve their programming skills and understanding of the language. It should also be useful for programmers coming to R from other languages, as help you to understand why R works the way it does." />
  <meta name="github-repo" content="hadley/adv-r" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="18 Expressions | Advanced R" />
  <meta name="twitter:site" content="@hadleywickham" />
  <meta name="twitter:description" content="The book is designed primarily for R users who want to improve their programming skills and understanding of the language. It should also be useful for programmers coming to R from other languages, as help you to understand why R works the way it does." />
  <meta name="twitter:image" content="https://adv-r.hadley.nz/cover.png" />

<meta name="author" content="Hadley Wickham" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="meta-big-picture.html"/>
<link rel="next" href="quasiquotation.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-141212623-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-141212623-1');
</script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="adv-r.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">Advanced R</a></strong></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i>License</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#other-books"><i class="fa fa-check"></i>Other books</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#why-r"><i class="fa fa-check"></i><b>1.1</b> Why R?</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#who-should-read"><i class="fa fa-check"></i><b>1.2</b> Who should read this book</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#what-you-will-get"><i class="fa fa-check"></i><b>1.3</b> What you will get out of this book</a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#what-you-will-not-learn"><i class="fa fa-check"></i><b>1.4</b> What you will not learn</a></li>
<li class="chapter" data-level="1.5" data-path="introduction.html"><a href="introduction.html#meta-techniques"><i class="fa fa-check"></i><b>1.5</b> Meta-techniques</a></li>
<li class="chapter" data-level="1.6" data-path="introduction.html"><a href="introduction.html#recommended-reading"><i class="fa fa-check"></i><b>1.6</b> Recommended reading</a></li>
<li class="chapter" data-level="1.7" data-path="introduction.html"><a href="introduction.html#getting-help"><i class="fa fa-check"></i><b>1.7</b> Getting help</a></li>
<li class="chapter" data-level="1.8" data-path="introduction.html"><a href="introduction.html#intro-ack"><i class="fa fa-check"></i><b>1.8</b> Acknowledgments</a></li>
<li class="chapter" data-level="1.9" data-path="introduction.html"><a href="introduction.html#conventions"><i class="fa fa-check"></i><b>1.9</b> Conventions</a></li>
<li class="chapter" data-level="1.10" data-path="introduction.html"><a href="introduction.html#colophon"><i class="fa fa-check"></i><b>1.10</b> Colophon</a></li>
</ul></li>
<li class="part"><span><b>I Foundations</b></span></li>
<li class="chapter" data-level="" data-path="foundations-intro.html"><a href="foundations-intro.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="2" data-path="names-values.html"><a href="names-values.html"><i class="fa fa-check"></i><b>2</b> Names and values</a><ul>
<li class="chapter" data-level="2.1" data-path="introduction.html"><a href="introduction.html#introduction"><i class="fa fa-check"></i><b>2.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="names-values.html"><a href="names-values.html#quiz"><i class="fa fa-check"></i>Quiz</a></li>
<li class="chapter" data-level="" data-path="names-values.html"><a href="names-values.html#outline"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="names-values.html"><a href="names-values.html#prerequisites"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="" data-path="names-values.html"><a href="names-values.html#sources"><i class="fa fa-check"></i>Sources</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="names-values.html"><a href="names-values.html#binding-basics"><i class="fa fa-check"></i><b>2.2</b> Binding basics</a><ul>
<li class="chapter" data-level="2.2.1" data-path="names-values.html"><a href="names-values.html#non-syntactic"><i class="fa fa-check"></i><b>2.2.1</b> Non-syntactic names</a></li>
<li class="chapter" data-level="2.2.2" data-path="names-values.html"><a href="names-values.html#exercises"><i class="fa fa-check"></i><b>2.2.2</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="names-values.html"><a href="names-values.html#copy-on-modify"><i class="fa fa-check"></i><b>2.3</b> Copy-on-modify</a><ul>
<li class="chapter" data-level="2.3.1" data-path="names-values.html"><a href="names-values.html#tracemem"><i class="fa fa-check"></i><b>2.3.1</b> <code>tracemem()</code></a></li>
<li class="chapter" data-level="2.3.2" data-path="names-values.html"><a href="names-values.html#function-calls"><i class="fa fa-check"></i><b>2.3.2</b> Function calls</a></li>
<li class="chapter" data-level="2.3.3" data-path="names-values.html"><a href="names-values.html#list-references"><i class="fa fa-check"></i><b>2.3.3</b> Lists</a></li>
<li class="chapter" data-level="2.3.4" data-path="names-values.html"><a href="names-values.html#df-modify"><i class="fa fa-check"></i><b>2.3.4</b> Data frames</a></li>
<li class="chapter" data-level="2.3.5" data-path="names-values.html"><a href="names-values.html#character-vectors"><i class="fa fa-check"></i><b>2.3.5</b> Character vectors</a></li>
<li class="chapter" data-level="2.3.6" data-path="names-values.html"><a href="names-values.html#exercises-1"><i class="fa fa-check"></i><b>2.3.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="names-values.html"><a href="names-values.html#object-size"><i class="fa fa-check"></i><b>2.4</b> Object size</a><ul>
<li class="chapter" data-level="2.4.1" data-path="names-values.html"><a href="names-values.html#exercises-2"><i class="fa fa-check"></i><b>2.4.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="names-values.html"><a href="names-values.html#modify-in-place"><i class="fa fa-check"></i><b>2.5</b> Modify-in-place</a><ul>
<li class="chapter" data-level="2.5.1" data-path="names-values.html"><a href="names-values.html#single-binding"><i class="fa fa-check"></i><b>2.5.1</b> Objects with a single binding</a></li>
<li class="chapter" data-level="2.5.2" data-path="names-values.html"><a href="names-values.html#env-modify"><i class="fa fa-check"></i><b>2.5.2</b> Environments</a></li>
<li class="chapter" data-level="2.5.3" data-path="names-values.html"><a href="names-values.html#exercises-3"><i class="fa fa-check"></i><b>2.5.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="names-values.html"><a href="names-values.html#gc"><i class="fa fa-check"></i><b>2.6</b> Unbinding and the garbage collector</a></li>
<li class="chapter" data-level="2.7" data-path="names-values.html"><a href="names-values.html#names-values-answers"><i class="fa fa-check"></i><b>2.7</b> Quiz answers</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="vectors-chap.html"><a href="vectors-chap.html"><i class="fa fa-check"></i><b>3</b> Vectors</a><ul>
<li class="chapter" data-level="3.1" data-path="introduction.html"><a href="introduction.html#introduction"><i class="fa fa-check"></i><b>3.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="names-values.html"><a href="names-values.html#quiz"><i class="fa fa-check"></i>Quiz</a></li>
<li class="chapter" data-level="" data-path="names-values.html"><a href="names-values.html#outline"><i class="fa fa-check"></i>Outline</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="vectors-chap.html"><a href="vectors-chap.html#atomic-vectors"><i class="fa fa-check"></i><b>3.2</b> Atomic vectors</a><ul>
<li class="chapter" data-level="3.2.1" data-path="vectors-chap.html"><a href="vectors-chap.html#scalars"><i class="fa fa-check"></i><b>3.2.1</b> Scalars</a></li>
<li class="chapter" data-level="3.2.2" data-path="vectors-chap.html"><a href="vectors-chap.html#atomic-constructing"><i class="fa fa-check"></i><b>3.2.2</b> Making longer vectors with <code>c()</code></a></li>
<li class="chapter" data-level="3.2.3" data-path="vectors-chap.html"><a href="vectors-chap.html#missing-values"><i class="fa fa-check"></i><b>3.2.3</b> Missing values</a></li>
<li class="chapter" data-level="3.2.4" data-path="vectors-chap.html"><a href="vectors-chap.html#testing-and-coercion"><i class="fa fa-check"></i><b>3.2.4</b> Testing and coercion</a></li>
<li class="chapter" data-level="3.2.5" data-path="names-values.html"><a href="names-values.html#exercises"><i class="fa fa-check"></i><b>3.2.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="vectors-chap.html"><a href="vectors-chap.html#attributes"><i class="fa fa-check"></i><b>3.3</b> Attributes</a><ul>
<li class="chapter" data-level="3.3.1" data-path="vectors-chap.html"><a href="vectors-chap.html#getting-and-setting"><i class="fa fa-check"></i><b>3.3.1</b> Getting and setting</a></li>
<li class="chapter" data-level="3.3.2" data-path="vectors-chap.html"><a href="vectors-chap.html#attr-names"><i class="fa fa-check"></i><b>3.3.2</b> Names</a></li>
<li class="chapter" data-level="3.3.3" data-path="vectors-chap.html"><a href="vectors-chap.html#attr-dims"><i class="fa fa-check"></i><b>3.3.3</b> Dimensions</a></li>
<li class="chapter" data-level="3.3.4" data-path="names-values.html"><a href="names-values.html#exercises-1"><i class="fa fa-check"></i><b>3.3.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="vectors-chap.html"><a href="vectors-chap.html#s3-atomic-vectors"><i class="fa fa-check"></i><b>3.4</b> S3 atomic vectors</a><ul>
<li class="chapter" data-level="3.4.1" data-path="vectors-chap.html"><a href="vectors-chap.html#factors"><i class="fa fa-check"></i><b>3.4.1</b> Factors</a></li>
<li class="chapter" data-level="3.4.2" data-path="vectors-chap.html"><a href="vectors-chap.html#dates"><i class="fa fa-check"></i><b>3.4.2</b> Dates</a></li>
<li class="chapter" data-level="3.4.3" data-path="vectors-chap.html"><a href="vectors-chap.html#date-times"><i class="fa fa-check"></i><b>3.4.3</b> Date-times</a></li>
<li class="chapter" data-level="3.4.4" data-path="vectors-chap.html"><a href="vectors-chap.html#durations"><i class="fa fa-check"></i><b>3.4.4</b> Durations</a></li>
<li class="chapter" data-level="3.4.5" data-path="names-values.html"><a href="names-values.html#exercises-2"><i class="fa fa-check"></i><b>3.4.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="vectors-chap.html"><a href="vectors-chap.html#lists"><i class="fa fa-check"></i><b>3.5</b> Lists</a><ul>
<li class="chapter" data-level="3.5.1" data-path="vectors-chap.html"><a href="vectors-chap.html#list-creating"><i class="fa fa-check"></i><b>3.5.1</b> Creating</a></li>
<li class="chapter" data-level="3.5.2" data-path="vectors-chap.html"><a href="vectors-chap.html#list-types"><i class="fa fa-check"></i><b>3.5.2</b> Testing and coercion</a></li>
<li class="chapter" data-level="3.5.3" data-path="vectors-chap.html"><a href="vectors-chap.html#list-array"><i class="fa fa-check"></i><b>3.5.3</b> Matrices and arrays</a></li>
<li class="chapter" data-level="3.5.4" data-path="names-values.html"><a href="names-values.html#exercises-3"><i class="fa fa-check"></i><b>3.5.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="vectors-chap.html"><a href="vectors-chap.html#tibble"><i class="fa fa-check"></i><b>3.6</b> Data frames and tibbles</a><ul>
<li class="chapter" data-level="3.6.1" data-path="vectors-chap.html"><a href="vectors-chap.html#df-create"><i class="fa fa-check"></i><b>3.6.1</b> Creating</a></li>
<li class="chapter" data-level="3.6.2" data-path="vectors-chap.html"><a href="vectors-chap.html#rownames"><i class="fa fa-check"></i><b>3.6.2</b> Row names</a></li>
<li class="chapter" data-level="3.6.3" data-path="vectors-chap.html"><a href="vectors-chap.html#printing"><i class="fa fa-check"></i><b>3.6.3</b> Printing</a></li>
<li class="chapter" data-level="3.6.4" data-path="vectors-chap.html"><a href="vectors-chap.html#safe-subsetting"><i class="fa fa-check"></i><b>3.6.4</b> Subsetting</a></li>
<li class="chapter" data-level="3.6.5" data-path="vectors-chap.html"><a href="vectors-chap.html#df-test-coerce"><i class="fa fa-check"></i><b>3.6.5</b> Testing and coercing</a></li>
<li class="chapter" data-level="3.6.6" data-path="vectors-chap.html"><a href="vectors-chap.html#list-columns"><i class="fa fa-check"></i><b>3.6.6</b> List columns</a></li>
<li class="chapter" data-level="3.6.7" data-path="vectors-chap.html"><a href="vectors-chap.html#matrix-and-data-frame-columns"><i class="fa fa-check"></i><b>3.6.7</b> Matrix and data frame columns</a></li>
<li class="chapter" data-level="3.6.8" data-path="vectors-chap.html"><a href="vectors-chap.html#exercises-4"><i class="fa fa-check"></i><b>3.6.8</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="vectors-chap.html"><a href="vectors-chap.html#null"><i class="fa fa-check"></i><b>3.7</b> <code>NULL</code></a></li>
<li class="chapter" data-level="3.8" data-path="vectors-chap.html"><a href="vectors-chap.html#data-structure-answers"><i class="fa fa-check"></i><b>3.8</b> Quiz answers</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="subsetting.html"><a href="subsetting.html"><i class="fa fa-check"></i><b>4</b> Subsetting</a><ul>
<li class="chapter" data-level="4.1" data-path="introduction.html"><a href="introduction.html#introduction"><i class="fa fa-check"></i><b>4.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="names-values.html"><a href="names-values.html#quiz"><i class="fa fa-check"></i>Quiz</a></li>
<li class="chapter" data-level="" data-path="names-values.html"><a href="names-values.html#outline"><i class="fa fa-check"></i>Outline</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="subsetting.html"><a href="subsetting.html#subset-multiple"><i class="fa fa-check"></i><b>4.2</b> Selecting multiple elements</a><ul>
<li class="chapter" data-level="4.2.1" data-path="vectors-chap.html"><a href="vectors-chap.html#atomic-vectors"><i class="fa fa-check"></i><b>4.2.1</b> Atomic vectors</a></li>
<li class="chapter" data-level="4.2.2" data-path="vectors-chap.html"><a href="vectors-chap.html#lists"><i class="fa fa-check"></i><b>4.2.2</b> Lists</a></li>
<li class="chapter" data-level="4.2.3" data-path="subsetting.html"><a href="subsetting.html#matrix-subsetting"><i class="fa fa-check"></i><b>4.2.3</b> Matrices and arrays</a></li>
<li class="chapter" data-level="4.2.4" data-path="subsetting.html"><a href="subsetting.html#df-subsetting"><i class="fa fa-check"></i><b>4.2.4</b> Data frames and tibbles</a></li>
<li class="chapter" data-level="4.2.5" data-path="subsetting.html"><a href="subsetting.html#simplify-preserve"><i class="fa fa-check"></i><b>4.2.5</b> Preserving dimensionality</a></li>
<li class="chapter" data-level="4.2.6" data-path="names-values.html"><a href="names-values.html#exercises"><i class="fa fa-check"></i><b>4.2.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="subsetting.html"><a href="subsetting.html#subset-single"><i class="fa fa-check"></i><b>4.3</b> Selecting a single element</a><ul>
<li class="chapter" data-level="4.3.1" data-path="subsetting.html"><a href="subsetting.html#section"><i class="fa fa-check"></i><b>4.3.1</b> <code>[[</code></a></li>
<li class="chapter" data-level="4.3.2" data-path="subsetting.html"><a href="subsetting.html#section-1"><i class="fa fa-check"></i><b>4.3.2</b> <code>$</code></a></li>
<li class="chapter" data-level="4.3.3" data-path="subsetting.html"><a href="subsetting.html#subsetting-oob"><i class="fa fa-check"></i><b>4.3.3</b> Missing and out-of-bounds indices</a></li>
<li class="chapter" data-level="4.3.4" data-path="subsetting.html"><a href="subsetting.html#and-slot"><i class="fa fa-check"></i><b>4.3.4</b> <code>@</code> and <code>slot()</code></a></li>
<li class="chapter" data-level="4.3.5" data-path="names-values.html"><a href="names-values.html#exercises-1"><i class="fa fa-check"></i><b>4.3.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="subsetting.html"><a href="subsetting.html#subassignment"><i class="fa fa-check"></i><b>4.4</b> Subsetting and assignment</a></li>
<li class="chapter" data-level="4.5" data-path="subsetting.html"><a href="subsetting.html#applications"><i class="fa fa-check"></i><b>4.5</b> Applications</a><ul>
<li class="chapter" data-level="4.5.1" data-path="subsetting.html"><a href="subsetting.html#lookup-tables"><i class="fa fa-check"></i><b>4.5.1</b> Lookup tables (character subsetting)</a></li>
<li class="chapter" data-level="4.5.2" data-path="subsetting.html"><a href="subsetting.html#matching-merging"><i class="fa fa-check"></i><b>4.5.2</b> Matching and merging by hand (integer subsetting)</a></li>
<li class="chapter" data-level="4.5.3" data-path="subsetting.html"><a href="subsetting.html#random-samples-and-bootstraps-integer-subsetting"><i class="fa fa-check"></i><b>4.5.3</b> Random samples and bootstraps (integer subsetting)</a></li>
<li class="chapter" data-level="4.5.4" data-path="subsetting.html"><a href="subsetting.html#ordering-integer-subsetting"><i class="fa fa-check"></i><b>4.5.4</b> Ordering (integer subsetting)</a></li>
<li class="chapter" data-level="4.5.5" data-path="subsetting.html"><a href="subsetting.html#expanding-aggregated-counts-integer-subsetting"><i class="fa fa-check"></i><b>4.5.5</b> Expanding aggregated counts (integer subsetting)</a></li>
<li class="chapter" data-level="4.5.6" data-path="subsetting.html"><a href="subsetting.html#removing-columns-from-data-frames-character"><i class="fa fa-check"></i><b>4.5.6</b> Removing columns from data frames (character )</a></li>
<li class="chapter" data-level="4.5.7" data-path="subsetting.html"><a href="subsetting.html#selecting-rows-based-on-a-condition-logical-subsetting"><i class="fa fa-check"></i><b>4.5.7</b> Selecting rows based on a condition (logical subsetting)</a></li>
<li class="chapter" data-level="4.5.8" data-path="subsetting.html"><a href="subsetting.html#boolean-algebra-versus-sets-logical-and-integer"><i class="fa fa-check"></i><b>4.5.8</b> Boolean algebra versus sets (logical and integer )</a></li>
<li class="chapter" data-level="4.5.9" data-path="names-values.html"><a href="names-values.html#exercises-2"><i class="fa fa-check"></i><b>4.5.9</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="subsetting.html"><a href="subsetting.html#subsetting-answers"><i class="fa fa-check"></i><b>4.6</b> Quiz answers</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="control-flow.html"><a href="control-flow.html"><i class="fa fa-check"></i><b>5</b> Control flow</a><ul>
<li class="chapter" data-level="5.1" data-path="introduction.html"><a href="introduction.html#introduction"><i class="fa fa-check"></i><b>5.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="names-values.html"><a href="names-values.html#quiz"><i class="fa fa-check"></i>Quiz</a></li>
<li class="chapter" data-level="" data-path="names-values.html"><a href="names-values.html#outline"><i class="fa fa-check"></i>Outline</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="control-flow.html"><a href="control-flow.html#choices"><i class="fa fa-check"></i><b>5.2</b> Choices</a><ul>
<li class="chapter" data-level="5.2.1" data-path="control-flow.html"><a href="control-flow.html#invalid-inputs"><i class="fa fa-check"></i><b>5.2.1</b> Invalid inputs</a></li>
<li class="chapter" data-level="5.2.2" data-path="control-flow.html"><a href="control-flow.html#vectorised-if"><i class="fa fa-check"></i><b>5.2.2</b> Vectorised if</a></li>
<li class="chapter" data-level="5.2.3" data-path="control-flow.html"><a href="control-flow.html#switch"><i class="fa fa-check"></i><b>5.2.3</b> <code>switch()</code> statement</a></li>
<li class="chapter" data-level="5.2.4" data-path="names-values.html"><a href="names-values.html#exercises"><i class="fa fa-check"></i><b>5.2.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="control-flow.html"><a href="control-flow.html#loops"><i class="fa fa-check"></i><b>5.3</b> Loops</a><ul>
<li class="chapter" data-level="5.3.1" data-path="control-flow.html"><a href="control-flow.html#common-pitfalls"><i class="fa fa-check"></i><b>5.3.1</b> Common pitfalls</a></li>
<li class="chapter" data-level="5.3.2" data-path="control-flow.html"><a href="control-flow.html#for-family"><i class="fa fa-check"></i><b>5.3.2</b> Related tools</a></li>
<li class="chapter" data-level="5.3.3" data-path="names-values.html"><a href="names-values.html#exercises-1"><i class="fa fa-check"></i><b>5.3.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="control-flow.html"><a href="control-flow.html#control-flow-answers"><i class="fa fa-check"></i><b>5.4</b> Quiz answers</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>6</b> Functions</a><ul>
<li class="chapter" data-level="6.1" data-path="introduction.html"><a href="introduction.html#introduction"><i class="fa fa-check"></i><b>6.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="names-values.html"><a href="names-values.html#quiz"><i class="fa fa-check"></i>Quiz</a></li>
<li class="chapter" data-level="" data-path="names-values.html"><a href="names-values.html#outline"><i class="fa fa-check"></i>Outline</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="functions.html"><a href="functions.html#function-fundamentals"><i class="fa fa-check"></i><b>6.2</b> Function fundamentals</a><ul>
<li class="chapter" data-level="6.2.1" data-path="functions.html"><a href="functions.html#fun-components"><i class="fa fa-check"></i><b>6.2.1</b> Function components</a></li>
<li class="chapter" data-level="6.2.2" data-path="functions.html"><a href="functions.html#primitive-functions"><i class="fa fa-check"></i><b>6.2.2</b> Primitive functions</a></li>
<li class="chapter" data-level="6.2.3" data-path="functions.html"><a href="functions.html#first-class-functions"><i class="fa fa-check"></i><b>6.2.3</b> First-class functions</a></li>
<li class="chapter" data-level="6.2.4" data-path="functions.html"><a href="functions.html#invoking-a-function"><i class="fa fa-check"></i><b>6.2.4</b> Invoking a function</a></li>
<li class="chapter" data-level="6.2.5" data-path="names-values.html"><a href="names-values.html#exercises"><i class="fa fa-check"></i><b>6.2.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="functions.html"><a href="functions.html#function-composition"><i class="fa fa-check"></i><b>6.3</b> Function composition</a></li>
<li class="chapter" data-level="6.4" data-path="functions.html"><a href="functions.html#lexical-scoping"><i class="fa fa-check"></i><b>6.4</b> Lexical scoping</a><ul>
<li class="chapter" data-level="6.4.1" data-path="functions.html"><a href="functions.html#name-masking"><i class="fa fa-check"></i><b>6.4.1</b> Name masking</a></li>
<li class="chapter" data-level="6.4.2" data-path="functions.html"><a href="functions.html#functions-versus-variables"><i class="fa fa-check"></i><b>6.4.2</b> Functions versus variables</a></li>
<li class="chapter" data-level="6.4.3" data-path="functions.html"><a href="functions.html#fresh-start"><i class="fa fa-check"></i><b>6.4.3</b> A fresh start</a></li>
<li class="chapter" data-level="6.4.4" data-path="functions.html"><a href="functions.html#dynamic-lookup"><i class="fa fa-check"></i><b>6.4.4</b> Dynamic lookup</a></li>
<li class="chapter" data-level="6.4.5" data-path="names-values.html"><a href="names-values.html#exercises-1"><i class="fa fa-check"></i><b>6.4.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="functions.html"><a href="functions.html#lazy-evaluation"><i class="fa fa-check"></i><b>6.5</b> Lazy evaluation</a><ul>
<li class="chapter" data-level="6.5.1" data-path="functions.html"><a href="functions.html#promises"><i class="fa fa-check"></i><b>6.5.1</b> Promises</a></li>
<li class="chapter" data-level="6.5.2" data-path="functions.html"><a href="functions.html#default-arguments"><i class="fa fa-check"></i><b>6.5.2</b> Default arguments</a></li>
<li class="chapter" data-level="6.5.3" data-path="functions.html"><a href="functions.html#missing-arguments"><i class="fa fa-check"></i><b>6.5.3</b> Missing arguments</a></li>
<li class="chapter" data-level="6.5.4" data-path="names-values.html"><a href="names-values.html#exercises-2"><i class="fa fa-check"></i><b>6.5.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="functions.html"><a href="functions.html#fun-dot-dot-dot"><i class="fa fa-check"></i><b>6.6</b> <code>...</code> (dot-dot-dot)</a><ul>
<li class="chapter" data-level="6.6.1" data-path="names-values.html"><a href="names-values.html#exercises-3"><i class="fa fa-check"></i><b>6.6.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="functions.html"><a href="functions.html#exiting-a-function"><i class="fa fa-check"></i><b>6.7</b> Exiting a function</a><ul>
<li class="chapter" data-level="6.7.1" data-path="functions.html"><a href="functions.html#implicit-versus-explicit-returns"><i class="fa fa-check"></i><b>6.7.1</b> Implicit versus explicit returns</a></li>
<li class="chapter" data-level="6.7.2" data-path="functions.html"><a href="functions.html#invisible"><i class="fa fa-check"></i><b>6.7.2</b> Invisible values</a></li>
<li class="chapter" data-level="6.7.3" data-path="functions.html"><a href="functions.html#errors"><i class="fa fa-check"></i><b>6.7.3</b> Errors</a></li>
<li class="chapter" data-level="6.7.4" data-path="functions.html"><a href="functions.html#on-exit"><i class="fa fa-check"></i><b>6.7.4</b> Exit handlers</a></li>
<li class="chapter" data-level="6.7.5" data-path="vectors-chap.html"><a href="vectors-chap.html#exercises-4"><i class="fa fa-check"></i><b>6.7.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="functions.html"><a href="functions.html#function-forms"><i class="fa fa-check"></i><b>6.8</b> Function forms</a><ul>
<li class="chapter" data-level="6.8.1" data-path="functions.html"><a href="functions.html#prefix-transform"><i class="fa fa-check"></i><b>6.8.1</b> Rewriting to prefix form</a></li>
<li class="chapter" data-level="6.8.2" data-path="functions.html"><a href="functions.html#prefix-form"><i class="fa fa-check"></i><b>6.8.2</b> Prefix form</a></li>
<li class="chapter" data-level="6.8.3" data-path="functions.html"><a href="functions.html#infix-functions"><i class="fa fa-check"></i><b>6.8.3</b> Infix functions</a></li>
<li class="chapter" data-level="6.8.4" data-path="functions.html"><a href="functions.html#replacement-functions"><i class="fa fa-check"></i><b>6.8.4</b> Replacement functions</a></li>
<li class="chapter" data-level="6.8.5" data-path="functions.html"><a href="functions.html#special-forms"><i class="fa fa-check"></i><b>6.8.5</b> Special forms</a></li>
<li class="chapter" data-level="6.8.6" data-path="functions.html"><a href="functions.html#exercises-5"><i class="fa fa-check"></i><b>6.8.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="functions.html"><a href="functions.html#function-answers"><i class="fa fa-check"></i><b>6.9</b> Quiz answers</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="environments.html"><a href="environments.html"><i class="fa fa-check"></i><b>7</b> Environments</a><ul>
<li class="chapter" data-level="7.1" data-path="introduction.html"><a href="introduction.html#introduction"><i class="fa fa-check"></i><b>7.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="names-values.html"><a href="names-values.html#quiz"><i class="fa fa-check"></i>Quiz</a></li>
<li class="chapter" data-level="" data-path="names-values.html"><a href="names-values.html#outline"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="names-values.html"><a href="names-values.html#prerequisites"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="environments.html"><a href="environments.html#env-basics"><i class="fa fa-check"></i><b>7.2</b> Environment basics</a><ul>
<li class="chapter" data-level="7.2.1" data-path="environments.html"><a href="environments.html#basics"><i class="fa fa-check"></i><b>7.2.1</b> Basics</a></li>
<li class="chapter" data-level="7.2.2" data-path="environments.html"><a href="environments.html#important-environments"><i class="fa fa-check"></i><b>7.2.2</b> Important environments</a></li>
<li class="chapter" data-level="7.2.3" data-path="environments.html"><a href="environments.html#parents"><i class="fa fa-check"></i><b>7.2.3</b> Parents</a></li>
<li class="chapter" data-level="7.2.4" data-path="environments.html"><a href="environments.html#super-assignment--"><i class="fa fa-check"></i><b>7.2.4</b> Super assignment, <code>&lt;&lt;-</code></a></li>
<li class="chapter" data-level="7.2.5" data-path="vectors-chap.html"><a href="vectors-chap.html#getting-and-setting"><i class="fa fa-check"></i><b>7.2.5</b> Getting and setting</a></li>
<li class="chapter" data-level="7.2.6" data-path="environments.html"><a href="environments.html#advanced-bindings"><i class="fa fa-check"></i><b>7.2.6</b> Advanced bindings</a></li>
<li class="chapter" data-level="7.2.7" data-path="names-values.html"><a href="names-values.html#exercises"><i class="fa fa-check"></i><b>7.2.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="environments.html"><a href="environments.html#env-recursion"><i class="fa fa-check"></i><b>7.3</b> Recursing over environments</a><ul>
<li class="chapter" data-level="7.3.1" data-path="names-values.html"><a href="names-values.html#exercises-1"><i class="fa fa-check"></i><b>7.3.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="environments.html"><a href="environments.html#special-environments"><i class="fa fa-check"></i><b>7.4</b> Special environments</a><ul>
<li class="chapter" data-level="7.4.1" data-path="environments.html"><a href="environments.html#search-path"><i class="fa fa-check"></i><b>7.4.1</b> Package environments and the search path</a></li>
<li class="chapter" data-level="7.4.2" data-path="environments.html"><a href="environments.html#function-environments"><i class="fa fa-check"></i><b>7.4.2</b> The function environment</a></li>
<li class="chapter" data-level="7.4.3" data-path="environments.html"><a href="environments.html#namespaces"><i class="fa fa-check"></i><b>7.4.3</b> Namespaces</a></li>
<li class="chapter" data-level="7.4.4" data-path="environments.html"><a href="environments.html#execution-environments"><i class="fa fa-check"></i><b>7.4.4</b> Execution environments</a></li>
<li class="chapter" data-level="7.4.5" data-path="names-values.html"><a href="names-values.html#exercises-2"><i class="fa fa-check"></i><b>7.4.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="environments.html"><a href="environments.html#call-stack"><i class="fa fa-check"></i><b>7.5</b> Call stacks</a><ul>
<li class="chapter" data-level="7.5.1" data-path="environments.html"><a href="environments.html#simple-stack"><i class="fa fa-check"></i><b>7.5.1</b> Simple call stacks</a></li>
<li class="chapter" data-level="7.5.2" data-path="environments.html"><a href="environments.html#lazy-call-stack"><i class="fa fa-check"></i><b>7.5.2</b> Lazy evaluation</a></li>
<li class="chapter" data-level="7.5.3" data-path="environments.html"><a href="environments.html#frames"><i class="fa fa-check"></i><b>7.5.3</b> Frames</a></li>
<li class="chapter" data-level="7.5.4" data-path="environments.html"><a href="environments.html#dynamic-scope"><i class="fa fa-check"></i><b>7.5.4</b> Dynamic scope</a></li>
<li class="chapter" data-level="7.5.5" data-path="names-values.html"><a href="names-values.html#exercises-3"><i class="fa fa-check"></i><b>7.5.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="environments.html"><a href="environments.html#explicit-envs"><i class="fa fa-check"></i><b>7.6</b> As data structures</a></li>
<li class="chapter" data-level="7.7" data-path="environments.html"><a href="environments.html#env-answers"><i class="fa fa-check"></i><b>7.7</b> Quiz answers</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="conditions.html"><a href="conditions.html"><i class="fa fa-check"></i><b>8</b> Conditions</a><ul>
<li class="chapter" data-level="8.1" data-path="introduction.html"><a href="introduction.html#introduction"><i class="fa fa-check"></i><b>8.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="names-values.html"><a href="names-values.html#quiz"><i class="fa fa-check"></i>Quiz</a></li>
<li class="chapter" data-level="" data-path="names-values.html"><a href="names-values.html#outline"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="8.1.1" data-path="names-values.html"><a href="names-values.html#prerequisites"><i class="fa fa-check"></i><b>8.1.1</b> Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="conditions.html"><a href="conditions.html#signalling-conditions"><i class="fa fa-check"></i><b>8.2</b> Signalling conditions</a><ul>
<li class="chapter" data-level="8.2.1" data-path="functions.html"><a href="functions.html#errors"><i class="fa fa-check"></i><b>8.2.1</b> Errors</a></li>
<li class="chapter" data-level="8.2.2" data-path="conditions.html"><a href="conditions.html#warnings"><i class="fa fa-check"></i><b>8.2.2</b> Warnings</a></li>
<li class="chapter" data-level="8.2.3" data-path="conditions.html"><a href="conditions.html#messages"><i class="fa fa-check"></i><b>8.2.3</b> Messages</a></li>
<li class="chapter" data-level="8.2.4" data-path="names-values.html"><a href="names-values.html#exercises"><i class="fa fa-check"></i><b>8.2.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="conditions.html"><a href="conditions.html#ignoring-conditions"><i class="fa fa-check"></i><b>8.3</b> Ignoring conditions</a></li>
<li class="chapter" data-level="8.4" data-path="conditions.html"><a href="conditions.html#handling-conditions"><i class="fa fa-check"></i><b>8.4</b> Handling conditions</a><ul>
<li class="chapter" data-level="8.4.1" data-path="conditions.html"><a href="conditions.html#condition-objects"><i class="fa fa-check"></i><b>8.4.1</b> Condition objects</a></li>
<li class="chapter" data-level="8.4.2" data-path="conditions.html"><a href="conditions.html#exiting-handlers"><i class="fa fa-check"></i><b>8.4.2</b> Exiting handlers</a></li>
<li class="chapter" data-level="8.4.3" data-path="conditions.html"><a href="conditions.html#calling-handlers"><i class="fa fa-check"></i><b>8.4.3</b> Calling handlers</a></li>
<li class="chapter" data-level="8.4.4" data-path="conditions.html"><a href="conditions.html#call-stacks"><i class="fa fa-check"></i><b>8.4.4</b> Call stacks</a></li>
<li class="chapter" data-level="8.4.5" data-path="names-values.html"><a href="names-values.html#exercises-1"><i class="fa fa-check"></i><b>8.4.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="conditions.html"><a href="conditions.html#custom-conditions"><i class="fa fa-check"></i><b>8.5</b> Custom conditions</a><ul>
<li class="chapter" data-level="8.5.1" data-path="conditions.html"><a href="conditions.html#motivation"><i class="fa fa-check"></i><b>8.5.1</b> Motivation</a></li>
<li class="chapter" data-level="8.5.2" data-path="conditions.html"><a href="conditions.html#signalling"><i class="fa fa-check"></i><b>8.5.2</b> Signalling</a></li>
<li class="chapter" data-level="8.5.3" data-path="conditions.html"><a href="conditions.html#handling"><i class="fa fa-check"></i><b>8.5.3</b> Handling</a></li>
<li class="chapter" data-level="8.5.4" data-path="names-values.html"><a href="names-values.html#exercises-2"><i class="fa fa-check"></i><b>8.5.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="conditions.html"><a href="conditions.html#condition-applications"><i class="fa fa-check"></i><b>8.6</b> Applications</a><ul>
<li class="chapter" data-level="8.6.1" data-path="conditions.html"><a href="conditions.html#failure-value"><i class="fa fa-check"></i><b>8.6.1</b> Failure value</a></li>
<li class="chapter" data-level="8.6.2" data-path="conditions.html"><a href="conditions.html#try-success-failure"><i class="fa fa-check"></i><b>8.6.2</b> Success and failure values</a></li>
<li class="chapter" data-level="8.6.3" data-path="conditions.html"><a href="conditions.html#resignal"><i class="fa fa-check"></i><b>8.6.3</b> Resignal</a></li>
<li class="chapter" data-level="8.6.4" data-path="conditions.html"><a href="conditions.html#record"><i class="fa fa-check"></i><b>8.6.4</b> Record</a></li>
<li class="chapter" data-level="8.6.5" data-path="conditions.html"><a href="conditions.html#no-default-behaviour"><i class="fa fa-check"></i><b>8.6.5</b> No default behaviour</a></li>
<li class="chapter" data-level="8.6.6" data-path="names-values.html"><a href="names-values.html#exercises-3"><i class="fa fa-check"></i><b>8.6.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="conditions.html"><a href="conditions.html#conditions-answers"><i class="fa fa-check"></i><b>8.7</b> Quiz answers</a></li>
</ul></li>
<li class="part"><span><b>II Functional programming</b></span></li>
<li class="chapter" data-level="" data-path="fp.html"><a href="fp.html"><i class="fa fa-check"></i>Introduction</a><ul>
<li class="chapter" data-level="" data-path="fp.html"><a href="fp.html#functional-programming-languages"><i class="fa fa-check"></i>Functional programming languages</a></li>
<li class="chapter" data-level="" data-path="fp.html"><a href="fp.html#functional-style"><i class="fa fa-check"></i>Functional style</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="functionals.html"><a href="functionals.html"><i class="fa fa-check"></i><b>9</b> Functionals</a><ul>
<li class="chapter" data-level="9.1" data-path="introduction.html"><a href="introduction.html#introduction"><i class="fa fa-check"></i><b>9.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="names-values.html"><a href="names-values.html#outline"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="names-values.html"><a href="names-values.html#prerequisites"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="functionals.html"><a href="functionals.html#map"><i class="fa fa-check"></i><b>9.2</b> My first functional: <code>map()</code></a><ul>
<li class="chapter" data-level="9.2.1" data-path="functionals.html"><a href="functionals.html#map-atomic"><i class="fa fa-check"></i><b>9.2.1</b> Producing atomic vectors</a></li>
<li class="chapter" data-level="9.2.2" data-path="functionals.html"><a href="functionals.html#purrr-shortcuts"><i class="fa fa-check"></i><b>9.2.2</b> Anonymous functions and shortcuts</a></li>
<li class="chapter" data-level="9.2.3" data-path="functionals.html"><a href="functionals.html#passing-arguments"><i class="fa fa-check"></i><b>9.2.3</b> Passing arguments with <code>...</code></a></li>
<li class="chapter" data-level="9.2.4" data-path="functionals.html"><a href="functionals.html#argument-names"><i class="fa fa-check"></i><b>9.2.4</b> Argument names</a></li>
<li class="chapter" data-level="9.2.5" data-path="functionals.html"><a href="functionals.html#change-argument"><i class="fa fa-check"></i><b>9.2.5</b> Varying another argument</a></li>
<li class="chapter" data-level="9.2.6" data-path="names-values.html"><a href="names-values.html#exercises"><i class="fa fa-check"></i><b>9.2.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="functionals.html"><a href="functionals.html#purrr-style"><i class="fa fa-check"></i><b>9.3</b> Purrr style</a></li>
<li class="chapter" data-level="9.4" data-path="functionals.html"><a href="functionals.html#map-variants"><i class="fa fa-check"></i><b>9.4</b> Map variants</a><ul>
<li class="chapter" data-level="9.4.1" data-path="functionals.html"><a href="functionals.html#modify"><i class="fa fa-check"></i><b>9.4.1</b> Same type of output as input: <code>modify()</code></a></li>
<li class="chapter" data-level="9.4.2" data-path="functionals.html"><a href="functionals.html#map2"><i class="fa fa-check"></i><b>9.4.2</b> Two inputs: <code>map2()</code> and friends</a></li>
<li class="chapter" data-level="9.4.3" data-path="functionals.html"><a href="functionals.html#no-outputs-walk-and-friends"><i class="fa fa-check"></i><b>9.4.3</b> No outputs: <code>walk()</code> and friends</a></li>
<li class="chapter" data-level="9.4.4" data-path="functionals.html"><a href="functionals.html#iterating-over-values-and-indices"><i class="fa fa-check"></i><b>9.4.4</b> Iterating over values and indices</a></li>
<li class="chapter" data-level="9.4.5" data-path="functionals.html"><a href="functionals.html#pmap"><i class="fa fa-check"></i><b>9.4.5</b> Any number of inputs: <code>pmap()</code> and friends</a></li>
<li class="chapter" data-level="9.4.6" data-path="names-values.html"><a href="names-values.html#exercises-1"><i class="fa fa-check"></i><b>9.4.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="functionals.html"><a href="functionals.html#reduce"><i class="fa fa-check"></i><b>9.5</b> Reduce family</a><ul>
<li class="chapter" data-level="9.5.1" data-path="environments.html"><a href="environments.html#basics"><i class="fa fa-check"></i><b>9.5.1</b> Basics</a></li>
<li class="chapter" data-level="9.5.2" data-path="functionals.html"><a href="functionals.html#accumulate"><i class="fa fa-check"></i><b>9.5.2</b> Accumulate</a></li>
<li class="chapter" data-level="9.5.3" data-path="functionals.html"><a href="functionals.html#output-types"><i class="fa fa-check"></i><b>9.5.3</b> Output types</a></li>
<li class="chapter" data-level="9.5.4" data-path="functionals.html"><a href="functionals.html#multiple-inputs"><i class="fa fa-check"></i><b>9.5.4</b> Multiple inputs</a></li>
<li class="chapter" data-level="9.5.5" data-path="functionals.html"><a href="functionals.html#map-reduce"><i class="fa fa-check"></i><b>9.5.5</b> Map-reduce</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="functionals.html"><a href="functionals.html#predicate-functionals"><i class="fa fa-check"></i><b>9.6</b> Predicate functionals</a><ul>
<li class="chapter" data-level="9.6.1" data-path="functionals.html"><a href="functionals.html#basics-1"><i class="fa fa-check"></i><b>9.6.1</b> Basics</a></li>
<li class="chapter" data-level="9.6.2" data-path="functionals.html"><a href="functionals.html#predicate-map"><i class="fa fa-check"></i><b>9.6.2</b> Map variants</a></li>
<li class="chapter" data-level="9.6.3" data-path="names-values.html"><a href="names-values.html#exercises-2"><i class="fa fa-check"></i><b>9.6.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="functionals.html"><a href="functionals.html#base-functionals"><i class="fa fa-check"></i><b>9.7</b> Base functionals</a><ul>
<li class="chapter" data-level="9.7.1" data-path="functionals.html"><a href="functionals.html#matrices-and-arrays"><i class="fa fa-check"></i><b>9.7.1</b> Matrices and arrays</a></li>
<li class="chapter" data-level="9.7.2" data-path="functionals.html"><a href="functionals.html#mathematical-concerns"><i class="fa fa-check"></i><b>9.7.2</b> Mathematical concerns</a></li>
<li class="chapter" data-level="9.7.3" data-path="names-values.html"><a href="names-values.html#exercises-3"><i class="fa fa-check"></i><b>9.7.3</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="function-factories.html"><a href="function-factories.html"><i class="fa fa-check"></i><b>10</b> Function factories</a><ul>
<li class="chapter" data-level="10.1" data-path="introduction.html"><a href="introduction.html#introduction"><i class="fa fa-check"></i><b>10.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="names-values.html"><a href="names-values.html#outline"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="names-values.html"><a href="names-values.html#prerequisites"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="function-factories.html"><a href="function-factories.html#factory-fundamentals"><i class="fa fa-check"></i><b>10.2</b> Factory fundamentals</a><ul>
<li class="chapter" data-level="10.2.1" data-path="environments.html"><a href="environments.html#environments"><i class="fa fa-check"></i><b>10.2.1</b> Environments</a></li>
<li class="chapter" data-level="10.2.2" data-path="function-factories.html"><a href="function-factories.html#diagram-conventions"><i class="fa fa-check"></i><b>10.2.2</b> Diagram conventions</a></li>
<li class="chapter" data-level="10.2.3" data-path="function-factories.html"><a href="function-factories.html#forcing-evaluation"><i class="fa fa-check"></i><b>10.2.3</b> Forcing evaluation</a></li>
<li class="chapter" data-level="10.2.4" data-path="function-factories.html"><a href="function-factories.html#stateful-funs"><i class="fa fa-check"></i><b>10.2.4</b> Stateful functions</a></li>
<li class="chapter" data-level="10.2.5" data-path="function-factories.html"><a href="function-factories.html#factory-pitfalls"><i class="fa fa-check"></i><b>10.2.5</b> Garbage collection</a></li>
<li class="chapter" data-level="10.2.6" data-path="names-values.html"><a href="names-values.html#exercises"><i class="fa fa-check"></i><b>10.2.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="function-factories.html"><a href="function-factories.html#graph-fact"><i class="fa fa-check"></i><b>10.3</b> Graphical factories</a><ul>
<li class="chapter" data-level="10.3.1" data-path="function-factories.html"><a href="function-factories.html#labelling"><i class="fa fa-check"></i><b>10.3.1</b> Labelling</a></li>
<li class="chapter" data-level="10.3.2" data-path="function-factories.html"><a href="function-factories.html#histogram-bins"><i class="fa fa-check"></i><b>10.3.2</b> Histogram bins</a></li>
<li class="chapter" data-level="10.3.3" data-path="function-factories.html"><a href="function-factories.html#ggsave"><i class="fa fa-check"></i><b>10.3.3</b> <code>ggsave()</code></a></li>
<li class="chapter" data-level="10.3.4" data-path="names-values.html"><a href="names-values.html#exercises-1"><i class="fa fa-check"></i><b>10.3.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="function-factories.html"><a href="function-factories.html#stat-fact"><i class="fa fa-check"></i><b>10.4</b> Statistical factories</a><ul>
<li class="chapter" data-level="10.4.1" data-path="function-factories.html"><a href="function-factories.html#box-cox-transformation"><i class="fa fa-check"></i><b>10.4.1</b> Box-Cox transformation</a></li>
<li class="chapter" data-level="10.4.2" data-path="function-factories.html"><a href="function-factories.html#bootstrap-generators"><i class="fa fa-check"></i><b>10.4.2</b> Bootstrap generators</a></li>
<li class="chapter" data-level="10.4.3" data-path="function-factories.html"><a href="function-factories.html#MLE"><i class="fa fa-check"></i><b>10.4.3</b> Maximum likelihood estimation</a></li>
<li class="chapter" data-level="10.4.4" data-path="names-values.html"><a href="names-values.html#exercises-2"><i class="fa fa-check"></i><b>10.4.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="function-factories.html"><a href="function-factories.html#functional-factories"><i class="fa fa-check"></i><b>10.5</b> Function factories + functionals</a><ul>
<li class="chapter" data-level="10.5.1" data-path="names-values.html"><a href="names-values.html#exercises-3"><i class="fa fa-check"></i><b>10.5.1</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="function-operators.html"><a href="function-operators.html"><i class="fa fa-check"></i><b>11</b> Function operators</a><ul>
<li class="chapter" data-level="11.1" data-path="introduction.html"><a href="introduction.html#introduction"><i class="fa fa-check"></i><b>11.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="names-values.html"><a href="names-values.html#outline"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="names-values.html"><a href="names-values.html#prerequisites"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="function-operators.html"><a href="function-operators.html#existing-fos"><i class="fa fa-check"></i><b>11.2</b> Existing function operators</a><ul>
<li class="chapter" data-level="11.2.1" data-path="function-operators.html"><a href="function-operators.html#safely"><i class="fa fa-check"></i><b>11.2.1</b> Capturing errors with <code>purrr::safely()</code></a></li>
<li class="chapter" data-level="11.2.2" data-path="function-operators.html"><a href="function-operators.html#memoise"><i class="fa fa-check"></i><b>11.2.2</b> Caching computations with <code>memoise::memoise()</code></a></li>
<li class="chapter" data-level="11.2.3" data-path="names-values.html"><a href="names-values.html#exercises"><i class="fa fa-check"></i><b>11.2.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="function-operators.html"><a href="function-operators.html#fo-case-study"><i class="fa fa-check"></i><b>11.3</b> Case study: Creating your own function operators</a><ul>
<li class="chapter" data-level="11.3.1" data-path="names-values.html"><a href="names-values.html#exercises-1"><i class="fa fa-check"></i><b>11.3.1</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Object-oriented programming</b></span></li>
<li class="chapter" data-level="" data-path="oo.html"><a href="oo.html"><i class="fa fa-check"></i>Introduction</a><ul>
<li class="chapter" data-level="" data-path="oo.html"><a href="oo.html#oop-systems"><i class="fa fa-check"></i>OOP systems</a></li>
<li class="chapter" data-level="" data-path="oo.html"><a href="oo.html#oop-in-r"><i class="fa fa-check"></i>OOP in R</a></li>
<li class="chapter" data-level="" data-path="oo.html"><a href="oo.html#sloop"><i class="fa fa-check"></i>sloop</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="base-types.html"><a href="base-types.html"><i class="fa fa-check"></i><b>12</b> Base types</a><ul>
<li class="chapter" data-level="12.1" data-path="introduction.html"><a href="introduction.html#introduction"><i class="fa fa-check"></i><b>12.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="names-values.html"><a href="names-values.html#outline"><i class="fa fa-check"></i>Outline</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="base-types.html"><a href="base-types.html#base-vs-oo"><i class="fa fa-check"></i><b>12.2</b> Base versus OO objects</a></li>
<li class="chapter" data-level="12.3" data-path="base-types.html"><a href="base-types.html#base-types-2"><i class="fa fa-check"></i><b>12.3</b> Base types</a><ul>
<li class="chapter" data-level="12.3.1" data-path="base-types.html"><a href="base-types.html#numeric-type"><i class="fa fa-check"></i><b>12.3.1</b> Numeric type</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="s3.html"><a href="s3.html"><i class="fa fa-check"></i><b>13</b> S3</a><ul>
<li class="chapter" data-level="13.1" data-path="introduction.html"><a href="introduction.html#introduction"><i class="fa fa-check"></i><b>13.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="names-values.html"><a href="names-values.html#outline"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="names-values.html"><a href="names-values.html#prerequisites"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="s3.html"><a href="s3.html#s3-basics"><i class="fa fa-check"></i><b>13.2</b> Basics</a><ul>
<li class="chapter" data-level="13.2.1" data-path="names-values.html"><a href="names-values.html#exercises"><i class="fa fa-check"></i><b>13.2.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="s3.html"><a href="s3.html#s3-classes"><i class="fa fa-check"></i><b>13.3</b> Classes</a><ul>
<li class="chapter" data-level="13.3.1" data-path="s3.html"><a href="s3.html#s3-constructor"><i class="fa fa-check"></i><b>13.3.1</b> Constructors</a></li>
<li class="chapter" data-level="13.3.2" data-path="s3.html"><a href="s3.html#validators"><i class="fa fa-check"></i><b>13.3.2</b> Validators</a></li>
<li class="chapter" data-level="13.3.3" data-path="s3.html"><a href="s3.html#helpers"><i class="fa fa-check"></i><b>13.3.3</b> Helpers</a></li>
<li class="chapter" data-level="13.3.4" data-path="names-values.html"><a href="names-values.html#exercises-1"><i class="fa fa-check"></i><b>13.3.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="s3.html"><a href="s3.html#s3-methods"><i class="fa fa-check"></i><b>13.4</b> Generics and methods</a><ul>
<li class="chapter" data-level="13.4.1" data-path="s3.html"><a href="s3.html#method-dispatch"><i class="fa fa-check"></i><b>13.4.1</b> Method dispatch</a></li>
<li class="chapter" data-level="13.4.2" data-path="s3.html"><a href="s3.html#finding-methods"><i class="fa fa-check"></i><b>13.4.2</b> Finding methods</a></li>
<li class="chapter" data-level="13.4.3" data-path="s3.html"><a href="s3.html#s3-arguments"><i class="fa fa-check"></i><b>13.4.3</b> Creating methods</a></li>
<li class="chapter" data-level="13.4.4" data-path="names-values.html"><a href="names-values.html#exercises-2"><i class="fa fa-check"></i><b>13.4.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="s3.html"><a href="s3.html#object-styles"><i class="fa fa-check"></i><b>13.5</b> Object styles</a><ul>
<li class="chapter" data-level="13.5.1" data-path="names-values.html"><a href="names-values.html#exercises-3"><i class="fa fa-check"></i><b>13.5.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="s3.html"><a href="s3.html#s3-inheritance"><i class="fa fa-check"></i><b>13.6</b> Inheritance</a><ul>
<li class="chapter" data-level="13.6.1" data-path="s3.html"><a href="s3.html#nextmethod"><i class="fa fa-check"></i><b>13.6.1</b> <code>NextMethod()</code></a></li>
<li class="chapter" data-level="13.6.2" data-path="s3.html"><a href="s3.html#s3-subclassing"><i class="fa fa-check"></i><b>13.6.2</b> Allowing subclassing</a></li>
<li class="chapter" data-level="13.6.3" data-path="vectors-chap.html"><a href="vectors-chap.html#exercises-4"><i class="fa fa-check"></i><b>13.6.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="13.7" data-path="s3.html"><a href="s3.html#s3-dispatch"><i class="fa fa-check"></i><b>13.7</b> Dispatch details</a><ul>
<li class="chapter" data-level="13.7.1" data-path="s3.html"><a href="s3.html#implicit-class"><i class="fa fa-check"></i><b>13.7.1</b> S3 and base types</a></li>
<li class="chapter" data-level="13.7.2" data-path="s3.html"><a href="s3.html#internal-generics"><i class="fa fa-check"></i><b>13.7.2</b> Internal generics</a></li>
<li class="chapter" data-level="13.7.3" data-path="s3.html"><a href="s3.html#group-generics"><i class="fa fa-check"></i><b>13.7.3</b> Group generics</a></li>
<li class="chapter" data-level="13.7.4" data-path="s3.html"><a href="s3.html#double-dispatch"><i class="fa fa-check"></i><b>13.7.4</b> Double dispatch</a></li>
<li class="chapter" data-level="13.7.5" data-path="functions.html"><a href="functions.html#exercises-5"><i class="fa fa-check"></i><b>13.7.5</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="r6.html"><a href="r6.html"><i class="fa fa-check"></i><b>14</b> R6</a><ul>
<li class="chapter" data-level="14.1" data-path="introduction.html"><a href="introduction.html#introduction"><i class="fa fa-check"></i><b>14.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="names-values.html"><a href="names-values.html#outline"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="names-values.html"><a href="names-values.html#prerequisites"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="r6.html"><a href="r6.html#r6-classes"><i class="fa fa-check"></i><b>14.2</b> Classes and methods</a><ul>
<li class="chapter" data-level="14.2.1" data-path="r6.html"><a href="r6.html#method-chaining"><i class="fa fa-check"></i><b>14.2.1</b> Method chaining</a></li>
<li class="chapter" data-level="14.2.2" data-path="r6.html"><a href="r6.html#r6-important-methods"><i class="fa fa-check"></i><b>14.2.2</b> Important methods</a></li>
<li class="chapter" data-level="14.2.3" data-path="r6.html"><a href="r6.html#adding-methods-after-creation"><i class="fa fa-check"></i><b>14.2.3</b> Adding methods after creation</a></li>
<li class="chapter" data-level="14.2.4" data-path="r6.html"><a href="r6.html#inheritance"><i class="fa fa-check"></i><b>14.2.4</b> Inheritance</a></li>
<li class="chapter" data-level="14.2.5" data-path="r6.html"><a href="r6.html#introspection"><i class="fa fa-check"></i><b>14.2.5</b> Introspection</a></li>
<li class="chapter" data-level="14.2.6" data-path="names-values.html"><a href="names-values.html#exercises"><i class="fa fa-check"></i><b>14.2.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="r6.html"><a href="r6.html#r6-access"><i class="fa fa-check"></i><b>14.3</b> Controlling access</a><ul>
<li class="chapter" data-level="14.3.1" data-path="r6.html"><a href="r6.html#privacy"><i class="fa fa-check"></i><b>14.3.1</b> Privacy</a></li>
<li class="chapter" data-level="14.3.2" data-path="r6.html"><a href="r6.html#active-fields"><i class="fa fa-check"></i><b>14.3.2</b> Active fields</a></li>
<li class="chapter" data-level="14.3.3" data-path="names-values.html"><a href="names-values.html#exercises-1"><i class="fa fa-check"></i><b>14.3.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="r6.html"><a href="r6.html#r6-semantics"><i class="fa fa-check"></i><b>14.4</b> Reference semantics</a><ul>
<li class="chapter" data-level="14.4.1" data-path="r6.html"><a href="r6.html#reasoning"><i class="fa fa-check"></i><b>14.4.1</b> Reasoning</a></li>
<li class="chapter" data-level="14.4.2" data-path="r6.html"><a href="r6.html#finalizer"><i class="fa fa-check"></i><b>14.4.2</b> Finalizer</a></li>
<li class="chapter" data-level="14.4.3" data-path="r6.html"><a href="r6.html#r6-fields"><i class="fa fa-check"></i><b>14.4.3</b> R6 fields</a></li>
<li class="chapter" data-level="14.4.4" data-path="names-values.html"><a href="names-values.html#exercises-2"><i class="fa fa-check"></i><b>14.4.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="r6.html"><a href="r6.html#why-r6"><i class="fa fa-check"></i><b>14.5</b> Why R6?</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="s4.html"><a href="s4.html"><i class="fa fa-check"></i><b>15</b> S4</a><ul>
<li class="chapter" data-level="15.1" data-path="introduction.html"><a href="introduction.html#introduction"><i class="fa fa-check"></i><b>15.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="names-values.html"><a href="names-values.html#outline"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="s4.html"><a href="s4.html#learning-more"><i class="fa fa-check"></i>Learning more</a></li>
<li class="chapter" data-level="" data-path="names-values.html"><a href="names-values.html#prerequisites"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="s4.html"><a href="s4.html#s4-basics"><i class="fa fa-check"></i><b>15.2</b> Basics</a><ul>
<li class="chapter" data-level="15.2.1" data-path="names-values.html"><a href="names-values.html#exercises"><i class="fa fa-check"></i><b>15.2.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="s4.html"><a href="s4.html#s4-classes"><i class="fa fa-check"></i><b>15.3</b> Classes</a><ul>
<li class="chapter" data-level="15.3.1" data-path="r6.html"><a href="r6.html#inheritance"><i class="fa fa-check"></i><b>15.3.1</b> Inheritance</a></li>
<li class="chapter" data-level="15.3.2" data-path="r6.html"><a href="r6.html#introspection"><i class="fa fa-check"></i><b>15.3.2</b> Introspection</a></li>
<li class="chapter" data-level="15.3.3" data-path="s4.html"><a href="s4.html#redefinition"><i class="fa fa-check"></i><b>15.3.3</b> Redefinition</a></li>
<li class="chapter" data-level="15.3.4" data-path="s4.html"><a href="s4.html#helper"><i class="fa fa-check"></i><b>15.3.4</b> Helper</a></li>
<li class="chapter" data-level="15.3.5" data-path="s4.html"><a href="s4.html#validator"><i class="fa fa-check"></i><b>15.3.5</b> Validator</a></li>
<li class="chapter" data-level="15.3.6" data-path="names-values.html"><a href="names-values.html#exercises-1"><i class="fa fa-check"></i><b>15.3.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="s4.html"><a href="s4.html#s4-generics"><i class="fa fa-check"></i><b>15.4</b> Generics and methods</a><ul>
<li class="chapter" data-level="15.4.1" data-path="s4.html"><a href="s4.html#signature"><i class="fa fa-check"></i><b>15.4.1</b> Signature</a></li>
<li class="chapter" data-level="15.4.2" data-path="s4.html"><a href="s4.html#methods"><i class="fa fa-check"></i><b>15.4.2</b> Methods</a></li>
<li class="chapter" data-level="15.4.3" data-path="s4.html"><a href="s4.html#show-method"><i class="fa fa-check"></i><b>15.4.3</b> Show method</a></li>
<li class="chapter" data-level="15.4.4" data-path="s4.html"><a href="s4.html#accessors"><i class="fa fa-check"></i><b>15.4.4</b> Accessors</a></li>
<li class="chapter" data-level="15.4.5" data-path="names-values.html"><a href="names-values.html#exercises-2"><i class="fa fa-check"></i><b>15.4.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="s4.html"><a href="s4.html#s4-dispatch"><i class="fa fa-check"></i><b>15.5</b> Method dispatch</a><ul>
<li class="chapter" data-level="15.5.1" data-path="s4.html"><a href="s4.html#single-dispatch"><i class="fa fa-check"></i><b>15.5.1</b> Single dispatch</a></li>
<li class="chapter" data-level="15.5.2" data-path="s4.html"><a href="s4.html#multiple-inheritance"><i class="fa fa-check"></i><b>15.5.2</b> Multiple inheritance</a></li>
<li class="chapter" data-level="15.5.3" data-path="s4.html"><a href="s4.html#multiple-dispatch"><i class="fa fa-check"></i><b>15.5.3</b> Multiple dispatch</a></li>
<li class="chapter" data-level="15.5.4" data-path="s4.html"><a href="s4.html#multiple-dispatch-and-multiple-inheritance"><i class="fa fa-check"></i><b>15.5.4</b> Multiple dispatch and multiple inheritance</a></li>
<li class="chapter" data-level="15.5.5" data-path="names-values.html"><a href="names-values.html#exercises-3"><i class="fa fa-check"></i><b>15.5.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="s4.html"><a href="s4.html#s4-s3"><i class="fa fa-check"></i><b>15.6</b> S4 and S3</a><ul>
<li class="chapter" data-level="15.6.1" data-path="s4.html"><a href="s4.html#classes"><i class="fa fa-check"></i><b>15.6.1</b> Classes</a></li>
<li class="chapter" data-level="15.6.2" data-path="s4.html"><a href="s4.html#generics"><i class="fa fa-check"></i><b>15.6.2</b> Generics</a></li>
<li class="chapter" data-level="15.6.3" data-path="vectors-chap.html"><a href="vectors-chap.html#exercises-4"><i class="fa fa-check"></i><b>15.6.3</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="oo-tradeoffs.html"><a href="oo-tradeoffs.html"><i class="fa fa-check"></i><b>16</b> Trade-offs</a><ul>
<li class="chapter" data-level="16.1" data-path="introduction.html"><a href="introduction.html#introduction"><i class="fa fa-check"></i><b>16.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="names-values.html"><a href="names-values.html#outline"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="names-values.html"><a href="names-values.html#prerequisites"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="oo-tradeoffs.html"><a href="oo-tradeoffs.html#s3-s4"><i class="fa fa-check"></i><b>16.2</b> S4 versus S3</a></li>
<li class="chapter" data-level="16.3" data-path="oo-tradeoffs.html"><a href="oo-tradeoffs.html#s3-r6"><i class="fa fa-check"></i><b>16.3</b> R6 versus S3</a><ul>
<li class="chapter" data-level="16.3.1" data-path="oo-tradeoffs.html"><a href="oo-tradeoffs.html#namespacing"><i class="fa fa-check"></i><b>16.3.1</b> Namespacing</a></li>
<li class="chapter" data-level="16.3.2" data-path="oo-tradeoffs.html"><a href="oo-tradeoffs.html#threading-state"><i class="fa fa-check"></i><b>16.3.2</b> Threading state</a></li>
<li class="chapter" data-level="16.3.3" data-path="oo-tradeoffs.html"><a href="oo-tradeoffs.html#tradeoffs-pipe"><i class="fa fa-check"></i><b>16.3.3</b> Method chaining</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV Metaprogramming</b></span></li>
<li class="chapter" data-level="" data-path="metaprogramming.html"><a href="metaprogramming.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="17" data-path="meta-big-picture.html"><a href="meta-big-picture.html"><i class="fa fa-check"></i><b>17</b> Big picture</a><ul>
<li class="chapter" data-level="17.1" data-path="introduction.html"><a href="introduction.html#introduction"><i class="fa fa-check"></i><b>17.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="names-values.html"><a href="names-values.html#outline"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="names-values.html"><a href="names-values.html#prerequisites"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="meta-big-picture.html"><a href="meta-big-picture.html#code-data"><i class="fa fa-check"></i><b>17.2</b> Code is data</a></li>
<li class="chapter" data-level="17.3" data-path="meta-big-picture.html"><a href="meta-big-picture.html#code-tree"><i class="fa fa-check"></i><b>17.3</b> Code is a tree</a></li>
<li class="chapter" data-level="17.4" data-path="meta-big-picture.html"><a href="meta-big-picture.html#coding-code"><i class="fa fa-check"></i><b>17.4</b> Code can generate code</a></li>
<li class="chapter" data-level="17.5" data-path="meta-big-picture.html"><a href="meta-big-picture.html#eval-intro"><i class="fa fa-check"></i><b>17.5</b> Evaluation runs code</a></li>
<li class="chapter" data-level="17.6" data-path="meta-big-picture.html"><a href="meta-big-picture.html#eval-funs"><i class="fa fa-check"></i><b>17.6</b> Customising evaluation with functions</a></li>
<li class="chapter" data-level="17.7" data-path="meta-big-picture.html"><a href="meta-big-picture.html#eval-data"><i class="fa fa-check"></i><b>17.7</b> Customising evaluation with data</a></li>
<li class="chapter" data-level="17.8" data-path="meta-big-picture.html"><a href="meta-big-picture.html#quosure-intro"><i class="fa fa-check"></i><b>17.8</b> Quosures</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="expressions.html"><a href="expressions.html"><i class="fa fa-check"></i><b>18</b> Expressions</a><ul>
<li class="chapter" data-level="18.1" data-path="introduction.html"><a href="introduction.html#introduction"><i class="fa fa-check"></i><b>18.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="names-values.html"><a href="names-values.html#outline"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="names-values.html"><a href="names-values.html#prerequisites"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="expressions.html"><a href="expressions.html#ast"><i class="fa fa-check"></i><b>18.2</b> Abstract syntax trees</a><ul>
<li class="chapter" data-level="18.2.1" data-path="expressions.html"><a href="expressions.html#drawing"><i class="fa fa-check"></i><b>18.2.1</b> Drawing</a></li>
<li class="chapter" data-level="18.2.2" data-path="expressions.html"><a href="expressions.html#non-code-components"><i class="fa fa-check"></i><b>18.2.2</b> Non-code components</a></li>
<li class="chapter" data-level="18.2.3" data-path="expressions.html"><a href="expressions.html#infix-calls"><i class="fa fa-check"></i><b>18.2.3</b> Infix calls</a></li>
<li class="chapter" data-level="18.2.4" data-path="names-values.html"><a href="names-values.html#exercises"><i class="fa fa-check"></i><b>18.2.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="expressions.html"><a href="expressions.html#expression-details"><i class="fa fa-check"></i><b>18.3</b> Expressions</a><ul>
<li class="chapter" data-level="18.3.1" data-path="expressions.html"><a href="expressions.html#constants"><i class="fa fa-check"></i><b>18.3.1</b> Constants</a></li>
<li class="chapter" data-level="18.3.2" data-path="expressions.html"><a href="expressions.html#symbols"><i class="fa fa-check"></i><b>18.3.2</b> Symbols</a></li>
<li class="chapter" data-level="18.3.3" data-path="expressions.html"><a href="expressions.html#calls"><i class="fa fa-check"></i><b>18.3.3</b> Calls</a></li>
<li class="chapter" data-level="18.3.4" data-path="expressions.html"><a href="expressions.html#summary"><i class="fa fa-check"></i><b>18.3.4</b> Summary</a></li>
<li class="chapter" data-level="18.3.5" data-path="names-values.html"><a href="names-values.html#exercises-1"><i class="fa fa-check"></i><b>18.3.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="expressions.html"><a href="expressions.html#grammar"><i class="fa fa-check"></i><b>18.4</b> Parsing and grammar</a><ul>
<li class="chapter" data-level="18.4.1" data-path="expressions.html"><a href="expressions.html#operator-precedence"><i class="fa fa-check"></i><b>18.4.1</b> Operator precedence</a></li>
<li class="chapter" data-level="18.4.2" data-path="expressions.html"><a href="expressions.html#associativity"><i class="fa fa-check"></i><b>18.4.2</b> Associativity</a></li>
<li class="chapter" data-level="18.4.3" data-path="expressions.html"><a href="expressions.html#parsing"><i class="fa fa-check"></i><b>18.4.3</b> Parsing and deparsing</a></li>
<li class="chapter" data-level="18.4.4" data-path="names-values.html"><a href="names-values.html#exercises-2"><i class="fa fa-check"></i><b>18.4.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="18.5" data-path="expressions.html"><a href="expressions.html#ast-funs"><i class="fa fa-check"></i><b>18.5</b> Walking AST with recursive functions</a><ul>
<li class="chapter" data-level="18.5.1" data-path="expressions.html"><a href="expressions.html#finding-f-and-t"><i class="fa fa-check"></i><b>18.5.1</b> Finding F and T</a></li>
<li class="chapter" data-level="18.5.2" data-path="expressions.html"><a href="expressions.html#finding-all-variables-created-by-assignment"><i class="fa fa-check"></i><b>18.5.2</b> Finding all variables created by assignment</a></li>
<li class="chapter" data-level="18.5.3" data-path="names-values.html"><a href="names-values.html#exercises-3"><i class="fa fa-check"></i><b>18.5.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="18.6" data-path="expressions.html"><a href="expressions.html#expression-special"><i class="fa fa-check"></i><b>18.6</b> Specialised data structures</a><ul>
<li class="chapter" data-level="18.6.1" data-path="expressions.html"><a href="expressions.html#pairlists"><i class="fa fa-check"></i><b>18.6.1</b> Pairlists</a></li>
<li class="chapter" data-level="18.6.2" data-path="expressions.html"><a href="expressions.html#empty-symbol"><i class="fa fa-check"></i><b>18.6.2</b> Missing arguments</a></li>
<li class="chapter" data-level="18.6.3" data-path="expressions.html"><a href="expressions.html#expression-vectors"><i class="fa fa-check"></i><b>18.6.3</b> Expression vectors</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="quasiquotation.html"><a href="quasiquotation.html"><i class="fa fa-check"></i><b>19</b> Quasiquotation</a><ul>
<li class="chapter" data-level="19.1" data-path="introduction.html"><a href="introduction.html#introduction"><i class="fa fa-check"></i><b>19.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="names-values.html"><a href="names-values.html#outline"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="names-values.html"><a href="names-values.html#prerequisites"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="" data-path="quasiquotation.html"><a href="quasiquotation.html#related-work"><i class="fa fa-check"></i>Related work</a></li>
</ul></li>
<li class="chapter" data-level="19.2" data-path="quasiquotation.html"><a href="quasiquotation.html#quasi-motivation"><i class="fa fa-check"></i><b>19.2</b> Motivation</a><ul>
<li class="chapter" data-level="19.2.1" data-path="quasiquotation.html"><a href="quasiquotation.html#vocabulary"><i class="fa fa-check"></i><b>19.2.1</b> Vocabulary</a></li>
<li class="chapter" data-level="19.2.2" data-path="names-values.html"><a href="names-values.html#exercises"><i class="fa fa-check"></i><b>19.2.2</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="19.3" data-path="quasiquotation.html"><a href="quasiquotation.html#quoting"><i class="fa fa-check"></i><b>19.3</b> Quoting</a><ul>
<li class="chapter" data-level="19.3.1" data-path="quasiquotation.html"><a href="quasiquotation.html#capturing-expressions"><i class="fa fa-check"></i><b>19.3.1</b> Capturing expressions</a></li>
<li class="chapter" data-level="19.3.2" data-path="quasiquotation.html"><a href="quasiquotation.html#capturing-symbols"><i class="fa fa-check"></i><b>19.3.2</b> Capturing symbols</a></li>
<li class="chapter" data-level="19.3.3" data-path="quasiquotation.html"><a href="quasiquotation.html#with-base-r"><i class="fa fa-check"></i><b>19.3.3</b> With base R</a></li>
<li class="chapter" data-level="19.3.4" data-path="quasiquotation.html"><a href="quasiquotation.html#substitution"><i class="fa fa-check"></i><b>19.3.4</b> Substitution</a></li>
<li class="chapter" data-level="19.3.5" data-path="expressions.html"><a href="expressions.html#summary"><i class="fa fa-check"></i><b>19.3.5</b> Summary</a></li>
<li class="chapter" data-level="19.3.6" data-path="names-values.html"><a href="names-values.html#exercises-1"><i class="fa fa-check"></i><b>19.3.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="quasiquotation.html"><a href="quasiquotation.html#unquoting"><i class="fa fa-check"></i><b>19.4</b> Unquoting</a><ul>
<li class="chapter" data-level="19.4.1" data-path="quasiquotation.html"><a href="quasiquotation.html#unquoting-one-argument"><i class="fa fa-check"></i><b>19.4.1</b> Unquoting one argument</a></li>
<li class="chapter" data-level="19.4.2" data-path="quasiquotation.html"><a href="quasiquotation.html#unquoting-a-function"><i class="fa fa-check"></i><b>19.4.2</b> Unquoting a function</a></li>
<li class="chapter" data-level="19.4.3" data-path="quasiquotation.html"><a href="quasiquotation.html#unquote-missing"><i class="fa fa-check"></i><b>19.4.3</b> Unquoting a missing argument</a></li>
<li class="chapter" data-level="19.4.4" data-path="quasiquotation.html"><a href="quasiquotation.html#unquoting-in-special-forms"><i class="fa fa-check"></i><b>19.4.4</b> Unquoting in special forms</a></li>
<li class="chapter" data-level="19.4.5" data-path="quasiquotation.html"><a href="quasiquotation.html#unquoting-many-arguments"><i class="fa fa-check"></i><b>19.4.5</b> Unquoting many arguments</a></li>
<li class="chapter" data-level="19.4.6" data-path="quasiquotation.html"><a href="quasiquotation.html#the-polite-fiction-of"><i class="fa fa-check"></i><b>19.4.6</b> The polite fiction of <code>!!</code></a></li>
<li class="chapter" data-level="19.4.7" data-path="quasiquotation.html"><a href="quasiquotation.html#non-standard-ast"><i class="fa fa-check"></i><b>19.4.7</b> Non-standard ASTs</a></li>
<li class="chapter" data-level="19.4.8" data-path="names-values.html"><a href="names-values.html#exercises-2"><i class="fa fa-check"></i><b>19.4.8</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="19.5" data-path="quasiquotation.html"><a href="quasiquotation.html#base-nonquote"><i class="fa fa-check"></i><b>19.5</b> Non-quoting</a></li>
<li class="chapter" data-level="19.6" data-path="quasiquotation.html"><a href="quasiquotation.html#tidy-dots"><i class="fa fa-check"></i><b>19.6</b> <code>...</code> (dot-dot-dot)</a><ul>
<li class="chapter" data-level="19.6.1" data-path="quasiquotation.html"><a href="quasiquotation.html#examples"><i class="fa fa-check"></i><b>19.6.1</b> Examples</a></li>
<li class="chapter" data-level="19.6.2" data-path="quasiquotation.html"><a href="quasiquotation.html#exec"><i class="fa fa-check"></i><b>19.6.2</b> <code>exec()</code></a></li>
<li class="chapter" data-level="19.6.3" data-path="quasiquotation.html"><a href="quasiquotation.html#dots_list"><i class="fa fa-check"></i><b>19.6.3</b> <code>dots_list()</code></a></li>
<li class="chapter" data-level="19.6.4" data-path="quasiquotation.html"><a href="quasiquotation.html#do-call"><i class="fa fa-check"></i><b>19.6.4</b> With base R</a></li>
<li class="chapter" data-level="19.6.5" data-path="names-values.html"><a href="names-values.html#exercises-3"><i class="fa fa-check"></i><b>19.6.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="19.7" data-path="quasiquotation.html"><a href="quasiquotation.html#expr-case-studies"><i class="fa fa-check"></i><b>19.7</b> Case studies</a><ul>
<li class="chapter" data-level="19.7.1" data-path="quasiquotation.html"><a href="quasiquotation.html#lobstrast"><i class="fa fa-check"></i><b>19.7.1</b> <code>lobstr::ast()</code></a></li>
<li class="chapter" data-level="19.7.2" data-path="quasiquotation.html"><a href="quasiquotation.html#map-reduce-to-generate-code"><i class="fa fa-check"></i><b>19.7.2</b> Map-reduce to generate code</a></li>
<li class="chapter" data-level="19.7.3" data-path="quasiquotation.html"><a href="quasiquotation.html#slicing-an-array"><i class="fa fa-check"></i><b>19.7.3</b> Slicing an array</a></li>
<li class="chapter" data-level="19.7.4" data-path="quasiquotation.html"><a href="quasiquotation.html#new-function"><i class="fa fa-check"></i><b>19.7.4</b> Creating functions</a></li>
<li class="chapter" data-level="19.7.5" data-path="vectors-chap.html"><a href="vectors-chap.html#exercises-4"><i class="fa fa-check"></i><b>19.7.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="19.8" data-path="quasiquotation.html"><a href="quasiquotation.html#history"><i class="fa fa-check"></i><b>19.8</b> History</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="evaluation.html"><a href="evaluation.html"><i class="fa fa-check"></i><b>20</b> Evaluation</a><ul>
<li class="chapter" data-level="20.1" data-path="introduction.html"><a href="introduction.html#introduction"><i class="fa fa-check"></i><b>20.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="names-values.html"><a href="names-values.html#outline"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="names-values.html"><a href="names-values.html#prerequisites"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="20.2" data-path="evaluation.html"><a href="evaluation.html#eval"><i class="fa fa-check"></i><b>20.2</b> Evaluation basics</a><ul>
<li class="chapter" data-level="20.2.1" data-path="evaluation.html"><a href="evaluation.html#application-local"><i class="fa fa-check"></i><b>20.2.1</b> Application: <code>local()</code></a></li>
<li class="chapter" data-level="20.2.2" data-path="evaluation.html"><a href="evaluation.html#application-source"><i class="fa fa-check"></i><b>20.2.2</b> Application: <code>source()</code></a></li>
<li class="chapter" data-level="20.2.3" data-path="evaluation.html"><a href="evaluation.html#gotcha-function"><i class="fa fa-check"></i><b>20.2.3</b> Gotcha: <code>function()</code></a></li>
<li class="chapter" data-level="20.2.4" data-path="names-values.html"><a href="names-values.html#exercises"><i class="fa fa-check"></i><b>20.2.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="evaluation.html"><a href="evaluation.html#quosures"><i class="fa fa-check"></i><b>20.3</b> Quosures</a><ul>
<li class="chapter" data-level="20.3.1" data-path="evaluation.html"><a href="evaluation.html#creating"><i class="fa fa-check"></i><b>20.3.1</b> Creating</a></li>
<li class="chapter" data-level="20.3.2" data-path="evaluation.html"><a href="evaluation.html#evaluating"><i class="fa fa-check"></i><b>20.3.2</b> Evaluating</a></li>
<li class="chapter" data-level="20.3.3" data-path="evaluation.html"><a href="evaluation.html#quosure-dots"><i class="fa fa-check"></i><b>20.3.3</b> Dots</a></li>
<li class="chapter" data-level="20.3.4" data-path="evaluation.html"><a href="evaluation.html#quosure-impl"><i class="fa fa-check"></i><b>20.3.4</b> Under the hood</a></li>
<li class="chapter" data-level="20.3.5" data-path="evaluation.html"><a href="evaluation.html#nested-quosures"><i class="fa fa-check"></i><b>20.3.5</b> Nested quosures</a></li>
<li class="chapter" data-level="20.3.6" data-path="names-values.html"><a href="names-values.html#exercises-1"><i class="fa fa-check"></i><b>20.3.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="20.4" data-path="evaluation.html"><a href="evaluation.html#data-masks"><i class="fa fa-check"></i><b>20.4</b> Data masks</a><ul>
<li class="chapter" data-level="20.4.1" data-path="environments.html"><a href="environments.html#basics"><i class="fa fa-check"></i><b>20.4.1</b> Basics</a></li>
<li class="chapter" data-level="20.4.2" data-path="evaluation.html"><a href="evaluation.html#pronouns"><i class="fa fa-check"></i><b>20.4.2</b> Pronouns</a></li>
<li class="chapter" data-level="20.4.3" data-path="evaluation.html"><a href="evaluation.html#subset"><i class="fa fa-check"></i><b>20.4.3</b> Application: <code>subset()</code></a></li>
<li class="chapter" data-level="20.4.4" data-path="evaluation.html"><a href="evaluation.html#application-transform"><i class="fa fa-check"></i><b>20.4.4</b> Application: transform</a></li>
<li class="chapter" data-level="20.4.5" data-path="evaluation.html"><a href="evaluation.html#select"><i class="fa fa-check"></i><b>20.4.5</b> Application: <code>select()</code></a></li>
<li class="chapter" data-level="20.4.6" data-path="names-values.html"><a href="names-values.html#exercises-2"><i class="fa fa-check"></i><b>20.4.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="20.5" data-path="evaluation.html"><a href="evaluation.html#tidy-evaluation"><i class="fa fa-check"></i><b>20.5</b> Using tidy evaluation</a><ul>
<li class="chapter" data-level="20.5.1" data-path="evaluation.html"><a href="evaluation.html#quoting-and-unquoting"><i class="fa fa-check"></i><b>20.5.1</b> Quoting and unquoting</a></li>
<li class="chapter" data-level="20.5.2" data-path="evaluation.html"><a href="evaluation.html#handling-ambiguity"><i class="fa fa-check"></i><b>20.5.2</b> Handling ambiguity</a></li>
<li class="chapter" data-level="20.5.3" data-path="evaluation.html"><a href="evaluation.html#quoting-and-ambiguity"><i class="fa fa-check"></i><b>20.5.3</b> Quoting and ambiguity</a></li>
<li class="chapter" data-level="20.5.4" data-path="names-values.html"><a href="names-values.html#exercises-3"><i class="fa fa-check"></i><b>20.5.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="20.6" data-path="evaluation.html"><a href="evaluation.html#base-evaluation"><i class="fa fa-check"></i><b>20.6</b> Base evaluation</a><ul>
<li class="chapter" data-level="20.6.1" data-path="evaluation.html"><a href="evaluation.html#substitute"><i class="fa fa-check"></i><b>20.6.1</b> <code>substitute()</code></a></li>
<li class="chapter" data-level="20.6.2" data-path="evaluation.html"><a href="evaluation.html#match.call"><i class="fa fa-check"></i><b>20.6.2</b> <code>match.call()</code></a></li>
<li class="chapter" data-level="20.6.3" data-path="vectors-chap.html"><a href="vectors-chap.html#exercises-4"><i class="fa fa-check"></i><b>20.6.3</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="21" data-path="translation.html"><a href="translation.html"><i class="fa fa-check"></i><b>21</b> Translating R code</a><ul>
<li class="chapter" data-level="21.1" data-path="introduction.html"><a href="introduction.html#introduction"><i class="fa fa-check"></i><b>21.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="names-values.html"><a href="names-values.html#outline"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="names-values.html"><a href="names-values.html#prerequisites"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="21.2" data-path="translation.html"><a href="translation.html#html"><i class="fa fa-check"></i><b>21.2</b> HTML</a><ul>
<li class="chapter" data-level="21.2.1" data-path="translation.html"><a href="translation.html#goal"><i class="fa fa-check"></i><b>21.2.1</b> Goal</a></li>
<li class="chapter" data-level="21.2.2" data-path="translation.html"><a href="translation.html#escaping"><i class="fa fa-check"></i><b>21.2.2</b> Escaping</a></li>
<li class="chapter" data-level="21.2.3" data-path="translation.html"><a href="translation.html#basic-tag-functions"><i class="fa fa-check"></i><b>21.2.3</b> Basic tag functions</a></li>
<li class="chapter" data-level="21.2.4" data-path="translation.html"><a href="translation.html#tag-functions"><i class="fa fa-check"></i><b>21.2.4</b> Tag functions</a></li>
<li class="chapter" data-level="21.2.5" data-path="translation.html"><a href="translation.html#html-env"><i class="fa fa-check"></i><b>21.2.5</b> Processing all tags</a></li>
<li class="chapter" data-level="21.2.6" data-path="names-values.html"><a href="names-values.html#exercises"><i class="fa fa-check"></i><b>21.2.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="21.3" data-path="translation.html"><a href="translation.html#latex"><i class="fa fa-check"></i><b>21.3</b> LaTeX</a><ul>
<li class="chapter" data-level="21.3.1" data-path="translation.html"><a href="translation.html#latex-mathematics"><i class="fa fa-check"></i><b>21.3.1</b> LaTeX mathematics</a></li>
<li class="chapter" data-level="21.3.2" data-path="translation.html"><a href="translation.html#goal-1"><i class="fa fa-check"></i><b>21.3.2</b> Goal</a></li>
<li class="chapter" data-level="21.3.3" data-path="translation.html"><a href="translation.html#to_math"><i class="fa fa-check"></i><b>21.3.3</b> <code>to_math</code>()</a></li>
<li class="chapter" data-level="21.3.4" data-path="translation.html"><a href="translation.html#known-symbols"><i class="fa fa-check"></i><b>21.3.4</b> Known symbols</a></li>
<li class="chapter" data-level="21.3.5" data-path="translation.html"><a href="translation.html#unknown-symbols"><i class="fa fa-check"></i><b>21.3.5</b> Unknown symbols</a></li>
<li class="chapter" data-level="21.3.6" data-path="translation.html"><a href="translation.html#known-functions"><i class="fa fa-check"></i><b>21.3.6</b> Known functions</a></li>
<li class="chapter" data-level="21.3.7" data-path="translation.html"><a href="translation.html#unknown-functions"><i class="fa fa-check"></i><b>21.3.7</b> Unknown functions</a></li>
<li class="chapter" data-level="21.3.8" data-path="names-values.html"><a href="names-values.html#exercises-1"><i class="fa fa-check"></i><b>21.3.8</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>V Techniques</b></span></li>
<li class="chapter" data-level="" data-path="techniques.html"><a href="techniques.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="22" data-path="debugging.html"><a href="debugging.html"><i class="fa fa-check"></i><b>22</b> Debugging</a><ul>
<li class="chapter" data-level="22.1" data-path="introduction.html"><a href="introduction.html#introduction"><i class="fa fa-check"></i><b>22.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="names-values.html"><a href="names-values.html#outline"><i class="fa fa-check"></i>Outline</a></li>
</ul></li>
<li class="chapter" data-level="22.2" data-path="debugging.html"><a href="debugging.html#debugging-strategy"><i class="fa fa-check"></i><b>22.2</b> Overall approach</a></li>
<li class="chapter" data-level="22.3" data-path="debugging.html"><a href="debugging.html#traceback"><i class="fa fa-check"></i><b>22.3</b> Locating errors</a><ul>
<li class="chapter" data-level="22.3.1" data-path="debugging.html"><a href="debugging.html#debug-lazy"><i class="fa fa-check"></i><b>22.3.1</b> Lazy evaluation</a></li>
</ul></li>
<li class="chapter" data-level="22.4" data-path="debugging.html"><a href="debugging.html#browser"><i class="fa fa-check"></i><b>22.4</b> Interactive debugger</a><ul>
<li class="chapter" data-level="22.4.1" data-path="debugging.html"><a href="debugging.html#browser-commands"><i class="fa fa-check"></i><b>22.4.1</b> <code>browser()</code> commands</a></li>
<li class="chapter" data-level="22.4.2" data-path="debugging.html"><a href="debugging.html#alternatives"><i class="fa fa-check"></i><b>22.4.2</b> Alternatives</a></li>
<li class="chapter" data-level="22.4.3" data-path="debugging.html"><a href="debugging.html#debug-compiled"><i class="fa fa-check"></i><b>22.4.3</b> Compiled code</a></li>
</ul></li>
<li class="chapter" data-level="22.5" data-path="debugging.html"><a href="debugging.html#non-interactive-debugging"><i class="fa fa-check"></i><b>22.5</b> Non-interactive debugging</a><ul>
<li class="chapter" data-level="22.5.1" data-path="debugging.html"><a href="debugging.html#dump.frames"><i class="fa fa-check"></i><b>22.5.1</b> <code>dump.frames()</code></a></li>
<li class="chapter" data-level="22.5.2" data-path="debugging.html"><a href="debugging.html#print-debugging"><i class="fa fa-check"></i><b>22.5.2</b> Print debugging</a></li>
<li class="chapter" data-level="22.5.3" data-path="debugging.html"><a href="debugging.html#rmarkdown"><i class="fa fa-check"></i><b>22.5.3</b> RMarkdown</a></li>
</ul></li>
<li class="chapter" data-level="22.6" data-path="debugging.html"><a href="debugging.html#non-error-failures"><i class="fa fa-check"></i><b>22.6</b> Non-error failures</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="perf-measure.html"><a href="perf-measure.html"><i class="fa fa-check"></i><b>23</b> Measuring performance</a><ul>
<li class="chapter" data-level="23.1" data-path="introduction.html"><a href="introduction.html#introduction"><i class="fa fa-check"></i><b>23.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="names-values.html"><a href="names-values.html#outline"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="names-values.html"><a href="names-values.html#prerequisites"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="23.2" data-path="perf-measure.html"><a href="perf-measure.html#profiling"><i class="fa fa-check"></i><b>23.2</b> Profiling</a><ul>
<li class="chapter" data-level="23.2.1" data-path="perf-measure.html"><a href="perf-measure.html#visualising-profiles"><i class="fa fa-check"></i><b>23.2.1</b> Visualising profiles</a></li>
<li class="chapter" data-level="23.2.2" data-path="perf-measure.html"><a href="perf-measure.html#memory-profiling"><i class="fa fa-check"></i><b>23.2.2</b> Memory profiling</a></li>
<li class="chapter" data-level="23.2.3" data-path="perf-measure.html"><a href="perf-measure.html#limitations"><i class="fa fa-check"></i><b>23.2.3</b> Limitations</a></li>
<li class="chapter" data-level="23.2.4" data-path="names-values.html"><a href="names-values.html#exercises"><i class="fa fa-check"></i><b>23.2.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="23.3" data-path="perf-measure.html"><a href="perf-measure.html#microbenchmarking"><i class="fa fa-check"></i><b>23.3</b> Microbenchmarking</a><ul>
<li class="chapter" data-level="23.3.1" data-path="perf-measure.html"><a href="perf-measure.html#benchmark-results"><i class="fa fa-check"></i><b>23.3.1</b> <code>bench::mark()</code> results</a></li>
<li class="chapter" data-level="23.3.2" data-path="perf-measure.html"><a href="perf-measure.html#interpreting-results"><i class="fa fa-check"></i><b>23.3.2</b> Interpreting results</a></li>
<li class="chapter" data-level="23.3.3" data-path="names-values.html"><a href="names-values.html#exercises-1"><i class="fa fa-check"></i><b>23.3.3</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="24" data-path="perf-improve.html"><a href="perf-improve.html"><i class="fa fa-check"></i><b>24</b> Improving performance</a><ul>
<li class="chapter" data-level="24.1" data-path="introduction.html"><a href="introduction.html#introduction"><i class="fa fa-check"></i><b>24.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="names-values.html"><a href="names-values.html#outline"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="names-values.html"><a href="names-values.html#prerequisites"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="24.2" data-path="perf-improve.html"><a href="perf-improve.html#code-organisation"><i class="fa fa-check"></i><b>24.2</b> Code organisation</a></li>
<li class="chapter" data-level="24.3" data-path="perf-improve.html"><a href="perf-improve.html#already-solved"><i class="fa fa-check"></i><b>24.3</b> Checking for existing solutions</a><ul>
<li class="chapter" data-level="24.3.1" data-path="names-values.html"><a href="names-values.html#exercises"><i class="fa fa-check"></i><b>24.3.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="24.4" data-path="perf-improve.html"><a href="perf-improve.html#be-lazy"><i class="fa fa-check"></i><b>24.4</b> Doing as little as possible</a><ul>
<li class="chapter" data-level="24.4.1" data-path="perf-improve.html"><a href="perf-improve.html#mean"><i class="fa fa-check"></i><b>24.4.1</b> <code>mean()</code></a></li>
<li class="chapter" data-level="24.4.2" data-path="perf-improve.html"><a href="perf-improve.html#as.data.frame"><i class="fa fa-check"></i><b>24.4.2</b> <code>as.data.frame()</code></a></li>
<li class="chapter" data-level="24.4.3" data-path="names-values.html"><a href="names-values.html#exercises-1"><i class="fa fa-check"></i><b>24.4.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="24.5" data-path="perf-improve.html"><a href="perf-improve.html#vectorise"><i class="fa fa-check"></i><b>24.5</b> Vectorise</a><ul>
<li class="chapter" data-level="24.5.1" data-path="names-values.html"><a href="names-values.html#exercises-2"><i class="fa fa-check"></i><b>24.5.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="24.6" data-path="perf-improve.html"><a href="perf-improve.html#avoid-copies"><i class="fa fa-check"></i><b>24.6</b> Avoiding copies</a></li>
<li class="chapter" data-level="24.7" data-path="perf-improve.html"><a href="perf-improve.html#t-test"><i class="fa fa-check"></i><b>24.7</b> Case study: t-test</a></li>
<li class="chapter" data-level="24.8" data-path="perf-improve.html"><a href="perf-improve.html#more-techniques"><i class="fa fa-check"></i><b>24.8</b> Other techniques</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="rcpp.html"><a href="rcpp.html"><i class="fa fa-check"></i><b>25</b> Rewriting R code in C++</a><ul>
<li class="chapter" data-level="25.1" data-path="introduction.html"><a href="introduction.html#introduction"><i class="fa fa-check"></i><b>25.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="names-values.html"><a href="names-values.html#outline"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="names-values.html"><a href="names-values.html#prerequisites"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="25.2" data-path="rcpp.html"><a href="rcpp.html#rcpp-intro"><i class="fa fa-check"></i><b>25.2</b> Getting started with C++</a><ul>
<li class="chapter" data-level="25.2.1" data-path="rcpp.html"><a href="rcpp.html#no-inputs-scalar-output"><i class="fa fa-check"></i><b>25.2.1</b> No inputs, scalar output</a></li>
<li class="chapter" data-level="25.2.2" data-path="rcpp.html"><a href="rcpp.html#scalar-input-scalar-output"><i class="fa fa-check"></i><b>25.2.2</b> Scalar input, scalar output</a></li>
<li class="chapter" data-level="25.2.3" data-path="rcpp.html"><a href="rcpp.html#vector-input-scalar-output"><i class="fa fa-check"></i><b>25.2.3</b> Vector input, scalar output</a></li>
<li class="chapter" data-level="25.2.4" data-path="rcpp.html"><a href="rcpp.html#vector-input-vector-output"><i class="fa fa-check"></i><b>25.2.4</b> Vector input, vector output</a></li>
<li class="chapter" data-level="25.2.5" data-path="rcpp.html"><a href="rcpp.html#sourceCpp"><i class="fa fa-check"></i><b>25.2.5</b> Using sourceCpp</a></li>
<li class="chapter" data-level="25.2.6" data-path="rcpp.html"><a href="rcpp.html#exercise-started"><i class="fa fa-check"></i><b>25.2.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="25.3" data-path="rcpp.html"><a href="rcpp.html#rcpp-classes"><i class="fa fa-check"></i><b>25.3</b> Other classes</a><ul>
<li class="chapter" data-level="25.3.1" data-path="rcpp.html"><a href="rcpp.html#lists-and-data-frames"><i class="fa fa-check"></i><b>25.3.1</b> Lists and data frames</a></li>
<li class="chapter" data-level="25.3.2" data-path="rcpp.html"><a href="rcpp.html#functions-rcpp"><i class="fa fa-check"></i><b>25.3.2</b> Functions</a></li>
<li class="chapter" data-level="25.3.3" data-path="vectors-chap.html"><a href="vectors-chap.html#attributes"><i class="fa fa-check"></i><b>25.3.3</b> Attributes</a></li>
</ul></li>
<li class="chapter" data-level="25.4" data-path="rcpp.html"><a href="rcpp.html#rcpp-na"><i class="fa fa-check"></i><b>25.4</b> Missing values</a><ul>
<li class="chapter" data-level="25.4.1" data-path="vectors-chap.html"><a href="vectors-chap.html#scalars"><i class="fa fa-check"></i><b>25.4.1</b> Scalars</a></li>
<li class="chapter" data-level="25.4.2" data-path="rcpp.html"><a href="rcpp.html#strings"><i class="fa fa-check"></i><b>25.4.2</b> Strings</a></li>
<li class="chapter" data-level="25.4.3" data-path="rcpp.html"><a href="rcpp.html#boolean"><i class="fa fa-check"></i><b>25.4.3</b> Boolean</a></li>
<li class="chapter" data-level="25.4.4" data-path="rcpp.html"><a href="rcpp.html#vectors-rcpp"><i class="fa fa-check"></i><b>25.4.4</b> Vectors</a></li>
<li class="chapter" data-level="25.4.5" data-path="names-values.html"><a href="names-values.html#exercises"><i class="fa fa-check"></i><b>25.4.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="25.5" data-path="rcpp.html"><a href="rcpp.html#stl"><i class="fa fa-check"></i><b>25.5</b> Standard Template Library</a><ul>
<li class="chapter" data-level="25.5.1" data-path="rcpp.html"><a href="rcpp.html#using-iterators"><i class="fa fa-check"></i><b>25.5.1</b> Using iterators</a></li>
<li class="chapter" data-level="25.5.2" data-path="rcpp.html"><a href="rcpp.html#algorithms"><i class="fa fa-check"></i><b>25.5.2</b> Algorithms</a></li>
<li class="chapter" data-level="25.5.3" data-path="rcpp.html"><a href="rcpp.html#data-structures-rcpp"><i class="fa fa-check"></i><b>25.5.3</b> Data structures</a></li>
<li class="chapter" data-level="25.5.4" data-path="rcpp.html"><a href="rcpp.html#vectors-stl"><i class="fa fa-check"></i><b>25.5.4</b> Vectors</a></li>
<li class="chapter" data-level="25.5.5" data-path="rcpp.html"><a href="rcpp.html#sets"><i class="fa fa-check"></i><b>25.5.5</b> Sets</a></li>
<li class="chapter" data-level="25.5.6" data-path="functionals.html"><a href="functionals.html#map"><i class="fa fa-check"></i><b>25.5.6</b> Map</a></li>
<li class="chapter" data-level="25.5.7" data-path="names-values.html"><a href="names-values.html#exercises-1"><i class="fa fa-check"></i><b>25.5.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="25.6" data-path="rcpp.html"><a href="rcpp.html#rcpp-case-studies"><i class="fa fa-check"></i><b>25.6</b> Case studies</a><ul>
<li class="chapter" data-level="25.6.1" data-path="rcpp.html"><a href="rcpp.html#gibbs-sampler"><i class="fa fa-check"></i><b>25.6.1</b> Gibbs sampler</a></li>
<li class="chapter" data-level="25.6.2" data-path="rcpp.html"><a href="rcpp.html#r-vectorisation-versus-c-vectorisation"><i class="fa fa-check"></i><b>25.6.2</b> R vectorisation versus C++ vectorisation</a></li>
</ul></li>
<li class="chapter" data-level="25.7" data-path="rcpp.html"><a href="rcpp.html#rcpp-package"><i class="fa fa-check"></i><b>25.7</b> Using Rcpp in a package</a></li>
<li class="chapter" data-level="25.8" data-path="rcpp.html"><a href="rcpp.html#rcpp-more"><i class="fa fa-check"></i><b>25.8</b> Learning more</a></li>
<li class="chapter" data-level="25.9" data-path="rcpp.html"><a href="rcpp.html#acknowledgments"><i class="fa fa-check"></i><b>25.9</b> Acknowledgments</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Advanced R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="expressions" class="section level1">
<h1><span class="header-section-number">18</span> Expressions</h1>
<div id="introduction" class="section level2">
<h2><span class="header-section-number">18.1</span> Introduction</h2>
<p></p>
<p>To compute on the language, we first need to understand its structure. That requires some new vocabulary, some new tools, and some new ways of thinking about R code. The first of these is the distinction between an operation and its result. Take the following code, which multiplies a variable <code>x</code> by 10 and saves the result to a new variable called <code>y</code>. It doesnt work because we havent defined a variable called <code>x</code>:</p>
<div class="sourceCode" id="cb686"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb686-1" data-line-number="1">y &lt;-<span class="st"> </span>x <span class="op">*</span><span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb686-2" data-line-number="2"><span class="co">#&gt; Error in eval(expr, envir, enclos): object &#39;x&#39; not found</span></a></code></pre></div>
<p>It would be nice if we could capture the intent of the code without executing it. In other words, how can we separate our description of the action from the action itself?</p>
<p>One way is to use <code>rlang::expr()</code>:</p>
<div class="sourceCode" id="cb687"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb687-1" data-line-number="1">z &lt;-<span class="st"> </span>rlang<span class="op">::</span><span class="kw">expr</span>(y &lt;-<span class="st"> </span>x <span class="op">*</span><span class="st"> </span><span class="dv">10</span>)</a>
<a class="sourceLine" id="cb687-2" data-line-number="2">z</a>
<a class="sourceLine" id="cb687-3" data-line-number="3"><span class="co">#&gt; y &lt;- x * 10</span></a></code></pre></div>
<p><code>expr()</code> returns an expression, an object that captures the structure of the code without evaluating it (i.e.running it). If you have an expression, you can evaluate it with <code>base::eval()</code>:</p>
<div class="sourceCode" id="cb688"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb688-1" data-line-number="1">x &lt;-<span class="st"> </span><span class="dv">4</span></a>
<a class="sourceLine" id="cb688-2" data-line-number="2"><span class="kw">eval</span>(z)</a>
<a class="sourceLine" id="cb688-3" data-line-number="3">y</a>
<a class="sourceLine" id="cb688-4" data-line-number="4"><span class="co">#&gt; [1] 40</span></a></code></pre></div>
<p>The focus of this chapter is the data structures that underlie expressions. Mastering this knowledge will allow you to inspect and modify captured code, and to generate code with code. Well come back to <code>expr()</code> in Chapter <a href="quasiquotation.html#quasiquotation">19</a>, and to <code>eval()</code> in Chapter <a href="evaluation.html#evaluation">20</a>.</p>
<div id="outline" class="section level3 unnumbered">
<h3>Outline</h3>
<ul>
<li><p>Section <a href="expressions.html#ast">18.2</a> introduces the idea of the abstract syntax tree (AST),
and reveals the tree like structure that underlies all R code.</p></li>
<li><p>Section <a href="expressions.html#expression-details">18.3</a> dives into the details of the data
structures that underpin the AST: constants, symbols, and calls, which
are collectively known as expressions.</p></li>
<li><p>Section <a href="expressions.html#grammar">18.4</a> covers parsing, the act of converting the linear
sequence of character in code into the AST, and uses that idea to explore
some details of Rs grammar.</p></li>
<li><p>Section <a href="expressions.html#ast-funs">18.5</a> shows you how you can use recursive functions to
compute on the language, writing functions that compute with expressions.</p></li>
<li><p>Section <a href="expressions.html#expression-special">18.6</a> circles back to three more
specialised data structures: pairlists, missing arguments, and expression
vectors.</p></li>
</ul>
</div>
<div id="prerequisites" class="section level3 unnumbered">
<h3>Prerequisites</h3>
<p>Make sure youve read the metaprogramming overview in Chapter <a href="meta-big-picture.html#meta-big-picture">17</a> to get a broad overview of the motivation and the basic vocabulary. Youll also need the <a href="https://rlang.r-lib.org">rlang</a> package to capture and compute on expressions, and the <a href="https://lobstr.r-lib.org">lobstr</a> package to visualise them.</p>
<div class="sourceCode" id="cb689"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb689-1" data-line-number="1"><span class="kw">library</span>(rlang)</a>
<a class="sourceLine" id="cb689-2" data-line-number="2"><span class="kw">library</span>(lobstr)</a></code></pre></div>
</div>
</div>
<div id="ast" class="section level2">
<h2><span class="header-section-number">18.2</span> Abstract syntax trees</h2>
<p>
</p>
<p>Expressions are also called <strong>abstract syntax trees</strong> (ASTs) because the structure of code is hierarchical and can be naturally represented as a tree. Understanding this tree structure is crucial for inspecting and modifying expressions (i.e.metaprogramming).</p>
<div id="drawing" class="section level3">
<h3><span class="header-section-number">18.2.1</span> Drawing</h3>
<p></p>
<p>Well start by introducing some conventions for drawing ASTs, beginning with a simple call that shows their main components: <code>f(x, &quot;y&quot;, 1)</code>. Ill draw trees in two ways<a href="#fn59" class="footnote-ref" id="fnref59"><sup>59</sup></a>:</p>
<ul>
<li><p>By hand (i.e.with OmniGraffle):</p>
<p><img src="diagrams/expressions/simple.png" style="display: block; margin: auto;" /></p></li>
<li><p>With <code>lobstr::ast()</code>:</p>
<div class="sourceCode" id="cb690"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb690-1" data-line-number="1">lobstr<span class="op">::</span><span class="kw">ast</span>(<span class="kw">f</span>(x, <span class="st">&quot;y&quot;</span>, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb690-2" data-line-number="2"><span class="co">#&gt; f </span></a>
<a class="sourceLine" id="cb690-3" data-line-number="3"><span class="co">#&gt; x </span></a>
<a class="sourceLine" id="cb690-4" data-line-number="4"><span class="co">#&gt; &quot;y&quot; </span></a>
<a class="sourceLine" id="cb690-5" data-line-number="5"><span class="co">#&gt; 1</span></a></code></pre></div></li>
</ul>
<p>Both approaches share conventions as much as possible:</p>
<ul>
<li><p>The leaves of the tree are either symbols, like <code>f</code> and <code>x</code>, or constants,
like <code>1</code> or <code>&quot;y&quot;</code>. Symbols are drawn in purple and have rounded corners.
Constants have black borders and square corners. Strings and symbols are
easily confused, so strings are always surrounded in quotes.</p></li>
<li><p>The branches of the tree are call objects, which represent function calls,
and are drawn as orange rectangles. The first child (<code>f</code>) is the function
that gets called; the second and subsequent children (<code>x</code>, <code>&quot;y&quot;</code>, and <code>1</code>)
are the arguments to that function.</p></li>
</ul>
<p>Colours will be shown when <em>you</em> call <code>ast()</code>, but do not appear in the book for complicated technical reasons.</p>
<p>The above example only contained one function call, making for a very shallow tree. Most expressions will contain considerably more calls, creating trees with multiple levels. For example, consider the AST for <code>f(g(1, 2), h(3, 4, i()))</code>:</p>
<p><img src="diagrams/expressions/complicated.png" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb691"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb691-1" data-line-number="1">lobstr<span class="op">::</span><span class="kw">ast</span>(<span class="kw">f</span>(<span class="kw">g</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="kw">h</span>(<span class="dv">3</span>, <span class="dv">4</span>, <span class="kw">i</span>())))</a>
<a class="sourceLine" id="cb691-2" data-line-number="2"><span class="co">#&gt; f </span></a>
<a class="sourceLine" id="cb691-3" data-line-number="3"><span class="co">#&gt; g </span></a>
<a class="sourceLine" id="cb691-4" data-line-number="4"><span class="co">#&gt;  1 </span></a>
<a class="sourceLine" id="cb691-5" data-line-number="5"><span class="co">#&gt;  2 </span></a>
<a class="sourceLine" id="cb691-6" data-line-number="6"><span class="co">#&gt; h </span></a>
<a class="sourceLine" id="cb691-7" data-line-number="7"><span class="co">#&gt;   3 </span></a>
<a class="sourceLine" id="cb691-8" data-line-number="8"><span class="co">#&gt;   4 </span></a>
<a class="sourceLine" id="cb691-9" data-line-number="9"><span class="co">#&gt;   i</span></a></code></pre></div>
<p>You can read the hand-drawn diagrams from left-to-right (ignoring vertical position), and the lobstr-drawn diagrams from top-to-bottom (ignoring horizontal position). The depth within the tree is determined by the nesting of function calls. This also determines evaluation order, as evaluation generally proceeds from deepest-to-shallowest, but this is not guaranteed because of lazy evaluation (Section <a href="functions.html#lazy-evaluation">6.5</a>). Also note the appearance of <code>i()</code>, a function call with no arguments; its a branch with a single (symbol) leaf.</p>
</div>
<div id="non-code-components" class="section level3">
<h3><span class="header-section-number">18.2.2</span> Non-code components</h3>
<p></p>
<p>You might have wondered what makes these <em>abstract</em> syntax trees. They are abstract because they only capture important structural details of the code, not whitespace or comments:</p>
<div class="sourceCode" id="cb692"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb692-1" data-line-number="1"><span class="kw">ast</span>(</a>
<a class="sourceLine" id="cb692-2" data-line-number="2">  <span class="kw">f</span>(x,  y)  <span class="co"># important!</span></a>
<a class="sourceLine" id="cb692-3" data-line-number="3">)</a>
<a class="sourceLine" id="cb692-4" data-line-number="4"><span class="co">#&gt; f </span></a>
<a class="sourceLine" id="cb692-5" data-line-number="5"><span class="co">#&gt; x </span></a>
<a class="sourceLine" id="cb692-6" data-line-number="6"><span class="co">#&gt; y</span></a></code></pre></div>
<p>Theres only one place where whitespace affects the AST:</p>
<div class="sourceCode" id="cb693"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb693-1" data-line-number="1">lobstr<span class="op">::</span><span class="kw">ast</span>(y &lt;-<span class="st"> </span>x)</a>
<a class="sourceLine" id="cb693-2" data-line-number="2"><span class="co">#&gt; `&lt;-` </span></a>
<a class="sourceLine" id="cb693-3" data-line-number="3"><span class="co">#&gt; y </span></a>
<a class="sourceLine" id="cb693-4" data-line-number="4"><span class="co">#&gt; x</span></a>
<a class="sourceLine" id="cb693-5" data-line-number="5">lobstr<span class="op">::</span><span class="kw">ast</span>(y <span class="op">&lt;</span><span class="st"> </span><span class="op">-</span>x)</a>
<a class="sourceLine" id="cb693-6" data-line-number="6"><span class="co">#&gt; `&lt;` </span></a>
<a class="sourceLine" id="cb693-7" data-line-number="7"><span class="co">#&gt; y </span></a>
<a class="sourceLine" id="cb693-8" data-line-number="8"><span class="co">#&gt; `-` </span></a>
<a class="sourceLine" id="cb693-9" data-line-number="9"><span class="co">#&gt;   x</span></a></code></pre></div>
</div>
<div id="infix-calls" class="section level3">
<h3><span class="header-section-number">18.2.3</span> Infix calls</h3>
<p></p>
<p>Every call in R can be written in tree form because any call can be written in prefix form (Section <a href="functions.html#prefix-transform">6.8.1</a>). Take <code>y &lt;- x * 10</code> again: what are the functions that are being called? It is not as easy to spot as <code>f(x, 1)</code> because this expression contains two infix calls: <code>&lt;-</code> and <code>*</code>. That means that these two lines of code are equivalent:</p>
<div class="sourceCode" id="cb694"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb694-1" data-line-number="1">y &lt;-<span class="st"> </span>x <span class="op">*</span><span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb694-2" data-line-number="2"><span class="st">`</span><span class="dt">&lt;-</span><span class="st">`</span>(y, <span class="st">`</span><span class="dt">*</span><span class="st">`</span>(x, <span class="dv">10</span>))</a></code></pre></div>
<p>And they both have this AST<a href="#fn60" class="footnote-ref" id="fnref60"><sup>60</sup></a>:</p>
<p><img src="diagrams/expressions/prefix.png" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb695"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb695-1" data-line-number="1">lobstr<span class="op">::</span><span class="kw">ast</span>(y &lt;-<span class="st"> </span>x <span class="op">*</span><span class="st"> </span><span class="dv">10</span>)</a>
<a class="sourceLine" id="cb695-2" data-line-number="2"><span class="co">#&gt; `&lt;-` </span></a>
<a class="sourceLine" id="cb695-3" data-line-number="3"><span class="co">#&gt; y </span></a>
<a class="sourceLine" id="cb695-4" data-line-number="4"><span class="co">#&gt; `*` </span></a>
<a class="sourceLine" id="cb695-5" data-line-number="5"><span class="co">#&gt;   x </span></a>
<a class="sourceLine" id="cb695-6" data-line-number="6"><span class="co">#&gt;   10</span></a></code></pre></div>
<p>There really is no difference between the ASTs, and if you generate an expression with prefix calls, R will still print it in infix form:</p>
<div class="sourceCode" id="cb696"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb696-1" data-line-number="1"><span class="kw">expr</span>(<span class="st">`</span><span class="dt">&lt;-</span><span class="st">`</span>(y, <span class="st">`</span><span class="dt">*</span><span class="st">`</span>(x, <span class="dv">10</span>)))</a>
<a class="sourceLine" id="cb696-2" data-line-number="2"><span class="co">#&gt; y &lt;- x * 10</span></a></code></pre></div>
<p>The order in which infix operators are applied is governed by a set of rules called operator precedence, and well use <code>lobstr::ast()</code> to explore them in Section <a href="expressions.html#operator-precedence">18.4.1</a>.</p>
</div>
<div id="exercises" class="section level3">
<h3><span class="header-section-number">18.2.4</span> Exercises</h3>
<ol style="list-style-type: decimal">
<li><p>Reconstruct the code represented by the trees below:</p>
<pre><code>#&gt; f 
#&gt; g 
#&gt;   h
#&gt; `+` 
#&gt; `+` 
#&gt;  1 
#&gt;  2 
#&gt; 3
#&gt; `*` 
#&gt; `(` 
#&gt;  `+` 
#&gt;    x 
#&gt;    y 
#&gt; z</code></pre></li>
<li><p>Draw the following trees by hand and then check your answers with
<code>lobstr::ast()</code>.</p>
<div class="sourceCode" id="cb698"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb698-1" data-line-number="1"><span class="kw">f</span>(<span class="kw">g</span>(<span class="kw">h</span>(<span class="kw">i</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>))))</a>
<a class="sourceLine" id="cb698-2" data-line-number="2"><span class="kw">f</span>(<span class="dv">1</span>, <span class="kw">g</span>(<span class="dv">2</span>, <span class="kw">h</span>(<span class="dv">3</span>, <span class="kw">i</span>())))</a>
<a class="sourceLine" id="cb698-3" data-line-number="3"><span class="kw">f</span>(<span class="kw">g</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="kw">h</span>(<span class="dv">3</span>, <span class="kw">i</span>(<span class="dv">4</span>, <span class="dv">5</span>)))</a></code></pre></div></li>
<li><p>Whats happening with the ASTs below? (Hint: carefully read <code>?&quot;^&quot;</code>.)</p>
<div class="sourceCode" id="cb699"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb699-1" data-line-number="1">lobstr<span class="op">::</span><span class="kw">ast</span>(<span class="st">`</span><span class="dt">x</span><span class="st">`</span> <span class="op">+</span><span class="st"> `</span><span class="dt">y</span><span class="st">`</span>)</a>
<a class="sourceLine" id="cb699-2" data-line-number="2"><span class="co">#&gt; `+` </span></a>
<a class="sourceLine" id="cb699-3" data-line-number="3"><span class="co">#&gt; x </span></a>
<a class="sourceLine" id="cb699-4" data-line-number="4"><span class="co">#&gt; y</span></a>
<a class="sourceLine" id="cb699-5" data-line-number="5">lobstr<span class="op">::</span><span class="kw">ast</span>(x <span class="op">**</span><span class="st"> </span>y)</a>
<a class="sourceLine" id="cb699-6" data-line-number="6"><span class="co">#&gt; `^` </span></a>
<a class="sourceLine" id="cb699-7" data-line-number="7"><span class="co">#&gt; x </span></a>
<a class="sourceLine" id="cb699-8" data-line-number="8"><span class="co">#&gt; y</span></a>
<a class="sourceLine" id="cb699-9" data-line-number="9">lobstr<span class="op">::</span><span class="kw">ast</span>(<span class="dv">1</span> -&gt;<span class="st"> </span>x)</a>
<a class="sourceLine" id="cb699-10" data-line-number="10"><span class="co">#&gt; `&lt;-` </span></a>
<a class="sourceLine" id="cb699-11" data-line-number="11"><span class="co">#&gt; x </span></a>
<a class="sourceLine" id="cb699-12" data-line-number="12"><span class="co">#&gt; 1</span></a></code></pre></div></li>
<li><p>What is special about the AST below? (Hint: re-read Section
<a href="functions.html#fun-components">6.2.1</a>.)</p>
<div class="sourceCode" id="cb700"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb700-1" data-line-number="1">lobstr<span class="op">::</span><span class="kw">ast</span>(<span class="cf">function</span>(<span class="dt">x =</span> <span class="dv">1</span>, <span class="dt">y =</span> <span class="dv">2</span>) {})</a>
<a class="sourceLine" id="cb700-2" data-line-number="2"><span class="co">#&gt; `function` </span></a>
<a class="sourceLine" id="cb700-3" data-line-number="3"><span class="co">#&gt; x = 1 </span></a>
<a class="sourceLine" id="cb700-4" data-line-number="4"><span class="co">#&gt;  y = 2 </span></a>
<a class="sourceLine" id="cb700-5" data-line-number="5"><span class="co">#&gt; `{` </span></a>
<a class="sourceLine" id="cb700-6" data-line-number="6"><span class="co">#&gt; &lt;inline srcref&gt;</span></a></code></pre></div></li>
<li><p>What does the call tree of an <code>if</code> statement with multiple <code>else if</code>
conditions look like? Why?</p></li>
</ol>
</div>
</div>
<div id="expression-details" class="section level2">
<h2><span class="header-section-number">18.3</span> Expressions</h2>
<p>
</p>
<p>Collectively, the data structures present in the AST are called expressions. An <strong>expression</strong> is any member of the set of base types created by parsing code: constant scalars, symbols, call objects, and pairlists. These are the data structures used to represent captured code from <code>expr()</code>, and <code>is_expression(expr(...))</code> is always true<a href="#fn61" class="footnote-ref" id="fnref61"><sup>61</sup></a>. Constants, symbols and call objects are the most important, and are discussed below. Pairlists and empty symbols are more specialised and well come back to them in Sections <a href="expressions.html#pairlists">18.6.1</a> and Section <a href="expressions.html#empty-symbol">18.6.2</a>.</p>
<p>NB: In base R documentation expression is used to mean two things. As well as the definition above, expression is also used to refer to the type of object returned by <code>expression()</code> and <code>parse()</code>, which are basically lists of expressions as defined above. In this book Ill call these <strong>expression vectors</strong>, and Ill come back to them in Section <a href="expressions.html#expression-vectors">18.6.3</a>.</p>
<div id="constants" class="section level3">
<h3><span class="header-section-number">18.3.1</span> Constants</h3>
<p>
</p>
<p>Scalar constants are the simplest component of the AST. More precisely, a <strong>constant</strong> is either <code>NULL</code> or a length-1 atomic vector (or scalar, Section <a href="vectors-chap.html#scalars">3.2.1</a>) like <code>TRUE</code>, <code>1L</code>, <code>2.5</code> or <code>&quot;x&quot;</code>. You can test for a constant with <code>rlang::is_syntactic_literal()</code>.</p>
<p>Constants are self-quoting in the sense that the expression used to represent a constant is the same constant:</p>
<div class="sourceCode" id="cb701"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb701-1" data-line-number="1"><span class="kw">identical</span>(<span class="kw">expr</span>(<span class="ot">TRUE</span>), <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb701-2" data-line-number="2"><span class="co">#&gt; [1] TRUE</span></a>
<a class="sourceLine" id="cb701-3" data-line-number="3"><span class="kw">identical</span>(<span class="kw">expr</span>(<span class="dv">1</span>), <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb701-4" data-line-number="4"><span class="co">#&gt; [1] TRUE</span></a>
<a class="sourceLine" id="cb701-5" data-line-number="5"><span class="kw">identical</span>(<span class="kw">expr</span>(2L), 2L)</a>
<a class="sourceLine" id="cb701-6" data-line-number="6"><span class="co">#&gt; [1] TRUE</span></a>
<a class="sourceLine" id="cb701-7" data-line-number="7"><span class="kw">identical</span>(<span class="kw">expr</span>(<span class="st">&quot;x&quot;</span>), <span class="st">&quot;x&quot;</span>)</a>
<a class="sourceLine" id="cb701-8" data-line-number="8"><span class="co">#&gt; [1] TRUE</span></a></code></pre></div>
</div>
<div id="symbols" class="section level3">
<h3><span class="header-section-number">18.3.2</span> Symbols</h3>
<p>

</p>
<p>A <strong>symbol</strong> represents the name of an object like <code>x</code>, <code>mtcars</code>, or <code>mean</code>. In base R, the terms symbol and name are used interchangeably (i.e. <code>is.name()</code> is identical to <code>is.symbol()</code>), but in this book I used symbol consistently because name has many other meanings.</p>
<p>You can create a symbol in two ways: by capturing code that references an object with <code>expr()</code>, or turning a string into a symbol with <code>rlang::sym()</code>:</p>
<div class="sourceCode" id="cb702"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb702-1" data-line-number="1"><span class="kw">expr</span>(x)</a>
<a class="sourceLine" id="cb702-2" data-line-number="2"><span class="co">#&gt; x</span></a>
<a class="sourceLine" id="cb702-3" data-line-number="3"><span class="kw">sym</span>(<span class="st">&quot;x&quot;</span>)</a>
<a class="sourceLine" id="cb702-4" data-line-number="4"><span class="co">#&gt; x</span></a></code></pre></div>

<p>You can turn a symbol back into a string with <code>as.character()</code> or <code>rlang::as_string()</code>. <code>as_string()</code> has the advantage of clearly signalling that youll get a character vector of length 1.</p>
<div class="sourceCode" id="cb703"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb703-1" data-line-number="1"><span class="kw">as_string</span>(<span class="kw">expr</span>(x))</a>
<a class="sourceLine" id="cb703-2" data-line-number="2"><span class="co">#&gt; [1] &quot;x&quot;</span></a></code></pre></div>
<p>You can recognise a symbol because its printed without quotes, <code>str()</code> tells you that its a symbol, and <code>is.symbol()</code> is <code>TRUE</code>:</p>
<div class="sourceCode" id="cb704"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb704-1" data-line-number="1"><span class="kw">str</span>(<span class="kw">expr</span>(x))</a>
<a class="sourceLine" id="cb704-2" data-line-number="2"><span class="co">#&gt;  symbol x</span></a>
<a class="sourceLine" id="cb704-3" data-line-number="3"><span class="kw">is.symbol</span>(<span class="kw">expr</span>(x))</a>
<a class="sourceLine" id="cb704-4" data-line-number="4"><span class="co">#&gt; [1] TRUE</span></a></code></pre></div>
<p>The symbol type is not vectorised, i.e.a symbol is always length 1. If you want multiple symbols, youll need to put them in a list, using (e.g.) <code>rlang::syms()</code>.</p>
</div>
<div id="calls" class="section level3">
<h3><span class="header-section-number">18.3.3</span> Calls</h3>
<p>
</p>
<p>A <strong>call object</strong> represents a captured function call. Call objects are a special type of list<a href="#fn62" class="footnote-ref" id="fnref62"><sup>62</sup></a> where the first component specifies the function to call (usually a symbol), and the remaining elements are the arguments for that call. Call objects create branches in the AST, because calls can be nested inside other calls.</p>
<p>You can identify a call object when printed because it looks just like a function call. Confusingly <code>typeof()</code> and <code>str()</code> print language<a href="#fn63" class="footnote-ref" id="fnref63"><sup>63</sup></a> for call objects, but <code>is.call()</code> returns <code>TRUE</code>:</p>
<div class="sourceCode" id="cb705"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb705-1" data-line-number="1">lobstr<span class="op">::</span><span class="kw">ast</span>(<span class="kw">read.table</span>(<span class="st">&quot;important.csv&quot;</span>, <span class="dt">row.names =</span> <span class="ot">FALSE</span>))</a>
<a class="sourceLine" id="cb705-2" data-line-number="2"><span class="co">#&gt; read.table </span></a>
<a class="sourceLine" id="cb705-3" data-line-number="3"><span class="co">#&gt; &quot;important.csv&quot; </span></a>
<a class="sourceLine" id="cb705-4" data-line-number="4"><span class="co">#&gt; row.names = FALSE</span></a>
<a class="sourceLine" id="cb705-5" data-line-number="5">x &lt;-<span class="st"> </span><span class="kw">expr</span>(<span class="kw">read.table</span>(<span class="st">&quot;important.csv&quot;</span>, <span class="dt">row.names =</span> <span class="ot">FALSE</span>))</a>
<a class="sourceLine" id="cb705-6" data-line-number="6"></a>
<a class="sourceLine" id="cb705-7" data-line-number="7"><span class="kw">typeof</span>(x)</a>
<a class="sourceLine" id="cb705-8" data-line-number="8"><span class="co">#&gt; [1] &quot;language&quot;</span></a>
<a class="sourceLine" id="cb705-9" data-line-number="9"><span class="kw">is.call</span>(x)</a>
<a class="sourceLine" id="cb705-10" data-line-number="10"><span class="co">#&gt; [1] TRUE</span></a></code></pre></div>
<div id="subsetting" class="section level4">
<h4><span class="header-section-number">18.3.3.1</span> Subsetting</h4>
<p></p>
<p>Calls generally behave like lists, i.e.you can use standard subsetting tools. The first element of the call object is the function to call, which is usually a symbol:</p>
<div class="sourceCode" id="cb706"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb706-1" data-line-number="1">x[[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb706-2" data-line-number="2"><span class="co">#&gt; read.table</span></a>
<a class="sourceLine" id="cb706-3" data-line-number="3"><span class="kw">is.symbol</span>(x[[<span class="dv">1</span>]])</a>
<a class="sourceLine" id="cb706-4" data-line-number="4"><span class="co">#&gt; [1] TRUE</span></a></code></pre></div>
<p>The remainder of the elements are the arguments:</p>
<div class="sourceCode" id="cb707"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb707-1" data-line-number="1"><span class="kw">as.list</span>(x[<span class="op">-</span><span class="dv">1</span>])</a>
<a class="sourceLine" id="cb707-2" data-line-number="2"><span class="co">#&gt; [[1]]</span></a>
<a class="sourceLine" id="cb707-3" data-line-number="3"><span class="co">#&gt; [1] &quot;important.csv&quot;</span></a>
<a class="sourceLine" id="cb707-4" data-line-number="4"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb707-5" data-line-number="5"><span class="co">#&gt; $row.names</span></a>
<a class="sourceLine" id="cb707-6" data-line-number="6"><span class="co">#&gt; [1] FALSE</span></a></code></pre></div>
<p>You can extract individual arguments with <code>[[</code> or, if named, <code>$</code>:</p>
<div class="sourceCode" id="cb708"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb708-1" data-line-number="1">x[[<span class="dv">2</span>]]</a>
<a class="sourceLine" id="cb708-2" data-line-number="2"><span class="co">#&gt; [1] &quot;important.csv&quot;</span></a>
<a class="sourceLine" id="cb708-3" data-line-number="3">x<span class="op">$</span>row.names</a>
<a class="sourceLine" id="cb708-4" data-line-number="4"><span class="co">#&gt; [1] FALSE</span></a></code></pre></div>
<p>You can determine the number of arguments in a call object by subtracting 1 from its length:</p>
<div class="sourceCode" id="cb709"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb709-1" data-line-number="1"><span class="kw">length</span>(x) <span class="op">-</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb709-2" data-line-number="2"><span class="co">#&gt; [1] 2</span></a></code></pre></div>
<p>Extracting specific arguments from calls is challenging because of Rs flexible rules for argument matching: it could potentially be in any location, with the full name, with an abbreviated name, or with no name. To work around this problem, you can use <code>rlang::call_standardise()</code> which standardises all arguments to use the full name:
</p>
<div class="sourceCode" id="cb710"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb710-1" data-line-number="1">rlang<span class="op">::</span><span class="kw">call_standardise</span>(x)</a>
<a class="sourceLine" id="cb710-2" data-line-number="2"><span class="co">#&gt; read.table(file = &quot;important.csv&quot;, row.names = FALSE)</span></a></code></pre></div>
<p>(NB: If the function uses <code>...</code> its not possible to standardise all arguments.)</p>
<p>Calls can be modified in the same way as lists:</p>
<div class="sourceCode" id="cb711"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb711-1" data-line-number="1">x<span class="op">$</span>header &lt;-<span class="st"> </span><span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb711-2" data-line-number="2">x</a>
<a class="sourceLine" id="cb711-3" data-line-number="3"><span class="co">#&gt; read.table(&quot;important.csv&quot;, row.names = FALSE, header = TRUE)</span></a></code></pre></div>
</div>
<div id="function-position" class="section level4">
<h4><span class="header-section-number">18.3.3.2</span> Function position</h4>
<p></p>
<p>The first element of the call object is the <strong>function position</strong>. This contains the function that will be called when the object is evaluated, and is usually a symbol<a href="#fn64" class="footnote-ref" id="fnref64"><sup>64</sup></a>:</p>
<div class="sourceCode" id="cb712"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb712-1" data-line-number="1">lobstr<span class="op">::</span><span class="kw">ast</span>(<span class="kw">foo</span>())</a>
<a class="sourceLine" id="cb712-2" data-line-number="2"><span class="co">#&gt; foo</span></a></code></pre></div>
<p>While R allows you to surround the name of the function with quotes, the parser converts it to a symbol:</p>
<div class="sourceCode" id="cb713"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb713-1" data-line-number="1">lobstr<span class="op">::</span><span class="kw">ast</span>(<span class="st">&quot;foo&quot;</span>())</a>
<a class="sourceLine" id="cb713-2" data-line-number="2"><span class="co">#&gt; foo</span></a></code></pre></div>
<p>However, sometimes the function doesnt exist in the current environment and you need to do some computation to retrieve it: for example, if the function is in another package, is a method of an R6 object, or is created by a function factory. In this case, the function position will be occupied by another call:</p>
<div class="sourceCode" id="cb714"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb714-1" data-line-number="1">lobstr<span class="op">::</span><span class="kw">ast</span>(pkg<span class="op">::</span><span class="kw">foo</span>(<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb714-2" data-line-number="2"><span class="co">#&gt; `::` </span></a>
<a class="sourceLine" id="cb714-3" data-line-number="3"><span class="co">#&gt;  pkg </span></a>
<a class="sourceLine" id="cb714-4" data-line-number="4"><span class="co">#&gt;  foo </span></a>
<a class="sourceLine" id="cb714-5" data-line-number="5"><span class="co">#&gt; 1</span></a>
<a class="sourceLine" id="cb714-6" data-line-number="6">lobstr<span class="op">::</span><span class="kw">ast</span>(obj<span class="op">$</span><span class="kw">foo</span>(<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb714-7" data-line-number="7"><span class="co">#&gt; `$` </span></a>
<a class="sourceLine" id="cb714-8" data-line-number="8"><span class="co">#&gt;  obj </span></a>
<a class="sourceLine" id="cb714-9" data-line-number="9"><span class="co">#&gt;  foo </span></a>
<a class="sourceLine" id="cb714-10" data-line-number="10"><span class="co">#&gt; 1</span></a>
<a class="sourceLine" id="cb714-11" data-line-number="11">lobstr<span class="op">::</span><span class="kw">ast</span>(<span class="kw">foo</span>(<span class="dv">1</span>)(<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb714-12" data-line-number="12"><span class="co">#&gt; foo </span></a>
<a class="sourceLine" id="cb714-13" data-line-number="13"><span class="co">#&gt;  1 </span></a>
<a class="sourceLine" id="cb714-14" data-line-number="14"><span class="co">#&gt; 2</span></a></code></pre></div>
<p><img src="diagrams/expressions/call-call.png" style="display: block; margin: auto;" /></p>
</div>
<div id="call2" class="section level4">
<h4><span class="header-section-number">18.3.3.3</span> Constructing</h4>
<p>
</p>
<p>You can construct a call object from its components using <code>rlang::call2()</code>. The first argument is the name of the function to call (either as a string, a symbol, or another call). The remaining arguments will be passed along to the call:</p>
<div class="sourceCode" id="cb715"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb715-1" data-line-number="1"><span class="kw">call2</span>(<span class="st">&quot;mean&quot;</span>, <span class="dt">x =</span> <span class="kw">expr</span>(x), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb715-2" data-line-number="2"><span class="co">#&gt; mean(x = x, na.rm = TRUE)</span></a>
<a class="sourceLine" id="cb715-3" data-line-number="3"><span class="kw">call2</span>(<span class="kw">expr</span>(base<span class="op">::</span>mean), <span class="dt">x =</span> <span class="kw">expr</span>(x), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb715-4" data-line-number="4"><span class="co">#&gt; base::mean(x = x, na.rm = TRUE)</span></a></code></pre></div>
<p>Infix calls created in this way still print as usual.</p>
<div class="sourceCode" id="cb716"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb716-1" data-line-number="1"><span class="kw">call2</span>(<span class="st">&quot;&lt;-&quot;</span>, <span class="kw">expr</span>(x), <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb716-2" data-line-number="2"><span class="co">#&gt; x &lt;- 10</span></a></code></pre></div>
<p>Using <code>call2()</code> to create complex expressions is a bit clunky. Youll learn another technique in Chapter <a href="quasiquotation.html#quasiquotation">19</a>.</p>
</div>
</div>
<div id="summary" class="section level3">
<h3><span class="header-section-number">18.3.4</span> Summary</h3>
<p>The following table summarises the appearance of the different expression subtypes in <code>str()</code> and <code>typeof()</code>:</p>
<table>
<thead>
<tr class="header">
<th></th>
<th><code>str()</code></th>
<th><code>typeof()</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Scalar constant</td>
<td><code>logi</code>/<code>int</code>/<code>num</code>/<code>chr</code></td>
<td><code>logical</code>/<code>integer</code>/<code>double</code>/<code>character</code></td>
</tr>
<tr class="even">
<td>Symbol</td>
<td><code>symbol</code></td>
<td><code>symbol</code></td>
</tr>
<tr class="odd">
<td>Call object</td>
<td><code>language</code></td>
<td><code>language</code></td>
</tr>
<tr class="even">
<td>Pairlist</td>
<td>Dotted pair list</td>
<td><code>pairlist</code></td>
</tr>
<tr class="odd">
<td>Expression vector</td>
<td><code>expression()</code></td>
<td><code>expression</code></td>
</tr>
</tbody>
</table>
<p>Both base R and rlang provide functions for testing for each type of input, although the types covered are slightly different. You can easily tell them apart because all the base functions start with <code>is.</code> and the rlang functions start with <code>is_</code>.</p>
<div style="page-break-after: always;"></div>
<!-- New page so that there's no beak inside the table -->
<table>
<thead>
<tr class="header">
<th></th>
<th>base</th>
<th>rlang</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Scalar constant</td>
<td></td>
<td><code>is_syntactic_literal()</code></td>
</tr>
<tr class="even">
<td>Symbol</td>
<td><code>is.symbol()</code></td>
<td><code>is_symbol()</code></td>
</tr>
<tr class="odd">
<td>Call object</td>
<td><code>is.call()</code></td>
<td><code>is_call()</code></td>
</tr>
<tr class="even">
<td>Pairlist</td>
<td><code>is.pairlist()</code></td>
<td><code>is_pairlist()</code></td>
</tr>
<tr class="odd">
<td>Expression vector</td>
<td><code>is.expression()</code></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<div id="exercises-1" class="section level3">
<h3><span class="header-section-number">18.3.5</span> Exercises</h3>
<ol style="list-style-type: decimal">
<li><p>Which two of the six types of atomic vector cant appear in an expression?
Why? Similarly, why cant you create an expression that contains an atomic
vector of length greater than one?</p></li>
<li><p>What happens when you subset a call object to remove the first element?
e.g. <code>expr(read.csv(&quot;foo.csv&quot;, header = TRUE))[-1]</code>. Why?</p></li>
<li><p>Describe the differences between the following call objects.</p>
<div class="sourceCode" id="cb717"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb717-1" data-line-number="1">x &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">10</span></a>
<a class="sourceLine" id="cb717-2" data-line-number="2"></a>
<a class="sourceLine" id="cb717-3" data-line-number="3"><span class="kw">call2</span>(median, x, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb717-4" data-line-number="4"><span class="kw">call2</span>(<span class="kw">expr</span>(median), x, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb717-5" data-line-number="5"><span class="kw">call2</span>(median, <span class="kw">expr</span>(x), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb717-6" data-line-number="6"><span class="kw">call2</span>(<span class="kw">expr</span>(median), <span class="kw">expr</span>(x), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a></code></pre></div></li>
<li><p><code>rlang::call_standardise()</code> doesnt work so well for the following calls.
Why? What makes <code>mean()</code> special?</p>
<div class="sourceCode" id="cb718"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb718-1" data-line-number="1"><span class="kw">call_standardise</span>(<span class="kw">quote</span>(<span class="kw">mean</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)))</a>
<a class="sourceLine" id="cb718-2" data-line-number="2"><span class="co">#&gt; mean(x = 1:10, na.rm = TRUE)</span></a>
<a class="sourceLine" id="cb718-3" data-line-number="3"><span class="kw">call_standardise</span>(<span class="kw">quote</span>(<span class="kw">mean</span>(<span class="dt">n =</span> T, <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>)))</a>
<a class="sourceLine" id="cb718-4" data-line-number="4"><span class="co">#&gt; mean(x = 1:10, n = T)</span></a>
<a class="sourceLine" id="cb718-5" data-line-number="5"><span class="kw">call_standardise</span>(<span class="kw">quote</span>(<span class="kw">mean</span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, , <span class="ot">TRUE</span>)))</a>
<a class="sourceLine" id="cb718-6" data-line-number="6"><span class="co">#&gt; mean(x = 1:10, , TRUE)</span></a></code></pre></div></li>
<li><p>Why does this code not make sense?</p>
<div class="sourceCode" id="cb719"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb719-1" data-line-number="1">x &lt;-<span class="st"> </span><span class="kw">expr</span>(<span class="kw">foo</span>(<span class="dt">x =</span> <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb719-2" data-line-number="2"><span class="kw">names</span>(x) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>)</a></code></pre></div></li>
<li><p>Construct the expression <code>if(x &gt; 1) &quot;a&quot; else &quot;b&quot;</code> using multiple calls to
<code>call2()</code>. How does the code structure reflect the structure of the AST?</p></li>
</ol>
</div>
</div>
<div id="grammar" class="section level2">
<h2><span class="header-section-number">18.4</span> Parsing and grammar</h2>
<p></p>
<p>Weve talked a lot about expressions and the AST, but not about how expressions are created from code that you type (like <code>&quot;x + y&quot;</code>). The process by which a computer language takes a string and constructs an expression is called <strong>parsing</strong>, and is governed by a set of rules known as a <strong>grammar</strong>. In this section, well use <code>lobstr::ast()</code> to explore some of the details of Rs grammar, and then show how you can transform back and forth between expressions and strings.</p>
<div id="operator-precedence" class="section level3">
<h3><span class="header-section-number">18.4.1</span> Operator precedence</h3>
<p></p>
<p>Infix functions introduce two sources of ambiguity<a href="#fn65" class="footnote-ref" id="fnref65"><sup>65</sup></a>. The first source of ambiguity arises from infix functions: what does <code>1 + 2 * 3</code> yield? Do you get 9 (i.e. <code>(1 + 2) * 3</code>), or 7 (i.e. <code>1 + (2 * 3)</code>)? In other words, which of the two possible parse trees below does R use?</p>
<p><img src="diagrams/expressions/ambig-order.png" style="display: block; margin: auto;" /></p>
<p>Programming languages use conventions called <strong>operator precedence</strong> to resolve this ambiguity. We can use <code>ast()</code> to see what R does:</p>
<div class="sourceCode" id="cb720"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb720-1" data-line-number="1">lobstr<span class="op">::</span><span class="kw">ast</span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb720-2" data-line-number="2"><span class="co">#&gt; `+` </span></a>
<a class="sourceLine" id="cb720-3" data-line-number="3"><span class="co">#&gt; 1 </span></a>
<a class="sourceLine" id="cb720-4" data-line-number="4"><span class="co">#&gt; `*` </span></a>
<a class="sourceLine" id="cb720-5" data-line-number="5"><span class="co">#&gt;   2 </span></a>
<a class="sourceLine" id="cb720-6" data-line-number="6"><span class="co">#&gt;   3</span></a></code></pre></div>
<p>Predicting the precedence of arithmetic operations is usually easy because its drilled into you in school and is consistent across the vast majority of programming languages.</p>
<p>Predicting the precedence of other operators is harder. Theres one particularly surprising case in R: <code>!</code> has a much lower precedence (i.e.it binds less tightly) than you might expect. This allows you to write useful operations like:</p>
<div class="sourceCode" id="cb721"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb721-1" data-line-number="1">lobstr<span class="op">::</span><span class="kw">ast</span>(<span class="op">!</span>x <span class="op">%in%</span><span class="st"> </span>y)</a>
<a class="sourceLine" id="cb721-2" data-line-number="2"><span class="co">#&gt; `!` </span></a>
<a class="sourceLine" id="cb721-3" data-line-number="3"><span class="co">#&gt; `%in%` </span></a>
<a class="sourceLine" id="cb721-4" data-line-number="4"><span class="co">#&gt;   x </span></a>
<a class="sourceLine" id="cb721-5" data-line-number="5"><span class="co">#&gt;   y</span></a></code></pre></div>
<p>R has over 30 infix operators divided into 18 precedence groups. While the details are described in <code>?Syntax</code>, very few people have memorised the complete ordering. If theres any confusion, use parentheses!</p>
<div class="sourceCode" id="cb722"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb722-1" data-line-number="1">lobstr<span class="op">::</span><span class="kw">ast</span>((<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="dv">2</span>) <span class="op">*</span><span class="st"> </span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb722-2" data-line-number="2"><span class="co">#&gt; `*` </span></a>
<a class="sourceLine" id="cb722-3" data-line-number="3"><span class="co">#&gt; `(` </span></a>
<a class="sourceLine" id="cb722-4" data-line-number="4"><span class="co">#&gt;  `+` </span></a>
<a class="sourceLine" id="cb722-5" data-line-number="5"><span class="co">#&gt;    1 </span></a>
<a class="sourceLine" id="cb722-6" data-line-number="6"><span class="co">#&gt;    2 </span></a>
<a class="sourceLine" id="cb722-7" data-line-number="7"><span class="co">#&gt; 3</span></a></code></pre></div>
<p>Note the appearance of the parentheses in the AST as a call to the <code>(</code> function.</p>
</div>
<div id="associativity" class="section level3">
<h3><span class="header-section-number">18.4.2</span> Associativity</h3>
<p>The second source of ambiguity is introduced by repeated usage of the same infix function. For example, is <code>1 + 2 + 3</code> equivalent to <code>(1 + 2) + 3</code> or to <code>1 + (2 + 3)</code>? This normally doesnt matter because <code>x + (y + z) == (x + y) + z</code>, i.e.addition is associative, but is needed because some S3 classes define <code>+</code> in a non-associative way. For example, ggplot2 overloads <code>+</code> to build up a complex plot from simple pieces; this is non-associative because earlier layers are drawn underneath later layers (i.e. <code>geom_point()</code> + <code>geom_smooth()</code> does not yield the same plot as <code>geom_smooth()</code> + <code>geom_point()</code>).</p>
<p>In R, most operators are <strong>left-associative</strong>, i.e.the operations on the left are evaluated first:</p>
<div class="sourceCode" id="cb723"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb723-1" data-line-number="1">lobstr<span class="op">::</span><span class="kw">ast</span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb723-2" data-line-number="2"><span class="co">#&gt; `+` </span></a>
<a class="sourceLine" id="cb723-3" data-line-number="3"><span class="co">#&gt; `+` </span></a>
<a class="sourceLine" id="cb723-4" data-line-number="4"><span class="co">#&gt;  1 </span></a>
<a class="sourceLine" id="cb723-5" data-line-number="5"><span class="co">#&gt;  2 </span></a>
<a class="sourceLine" id="cb723-6" data-line-number="6"><span class="co">#&gt; 3</span></a></code></pre></div>
<p>There are two exceptions: exponentiation and assignment.</p>
<div class="sourceCode" id="cb724"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb724-1" data-line-number="1">lobstr<span class="op">::</span><span class="kw">ast</span>(<span class="dv">2</span><span class="op">^</span><span class="dv">2</span><span class="op">^</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb724-2" data-line-number="2"><span class="co">#&gt; `^` </span></a>
<a class="sourceLine" id="cb724-3" data-line-number="3"><span class="co">#&gt; 2 </span></a>
<a class="sourceLine" id="cb724-4" data-line-number="4"><span class="co">#&gt; `^` </span></a>
<a class="sourceLine" id="cb724-5" data-line-number="5"><span class="co">#&gt;   2 </span></a>
<a class="sourceLine" id="cb724-6" data-line-number="6"><span class="co">#&gt;   3</span></a>
<a class="sourceLine" id="cb724-7" data-line-number="7">lobstr<span class="op">::</span><span class="kw">ast</span>(x &lt;-<span class="st"> </span>y &lt;-<span class="st"> </span>z)</a>
<a class="sourceLine" id="cb724-8" data-line-number="8"><span class="co">#&gt; `&lt;-` </span></a>
<a class="sourceLine" id="cb724-9" data-line-number="9"><span class="co">#&gt; x </span></a>
<a class="sourceLine" id="cb724-10" data-line-number="10"><span class="co">#&gt; `&lt;-` </span></a>
<a class="sourceLine" id="cb724-11" data-line-number="11"><span class="co">#&gt;   y </span></a>
<a class="sourceLine" id="cb724-12" data-line-number="12"><span class="co">#&gt;   z</span></a></code></pre></div>
</div>
<div id="parsing" class="section level3">
<h3><span class="header-section-number">18.4.3</span> Parsing and deparsing</h3>
<p>
</p>
<p>Most of the time you type code into the console, and R takes care of turning the characters youve typed into an AST. But occasionally you have code stored in a string, and you want to parse it yourself. You can do so using <code>rlang::parse_expr()</code>:</p>
<div class="sourceCode" id="cb725"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb725-1" data-line-number="1">x1 &lt;-<span class="st"> &quot;y &lt;- x + 10&quot;</span></a>
<a class="sourceLine" id="cb725-2" data-line-number="2">x1</a>
<a class="sourceLine" id="cb725-3" data-line-number="3"><span class="co">#&gt; [1] &quot;y &lt;- x + 10&quot;</span></a>
<a class="sourceLine" id="cb725-4" data-line-number="4"><span class="kw">is.call</span>(x1)</a>
<a class="sourceLine" id="cb725-5" data-line-number="5"><span class="co">#&gt; [1] FALSE</span></a>
<a class="sourceLine" id="cb725-6" data-line-number="6"></a>
<a class="sourceLine" id="cb725-7" data-line-number="7">x2 &lt;-<span class="st"> </span>rlang<span class="op">::</span><span class="kw">parse_expr</span>(x1)</a>
<a class="sourceLine" id="cb725-8" data-line-number="8">x2</a>
<a class="sourceLine" id="cb725-9" data-line-number="9"><span class="co">#&gt; y &lt;- x + 10</span></a>
<a class="sourceLine" id="cb725-10" data-line-number="10"><span class="kw">is.call</span>(x2)</a>
<a class="sourceLine" id="cb725-11" data-line-number="11"><span class="co">#&gt; [1] TRUE</span></a></code></pre></div>
<p><code>parse_expr()</code> always returns a single expression. If you have multiple expression separated by <code>;</code> or <code>\n</code>, youll need to use <code>rlang::parse_exprs()</code>. It returns a list of expressions:</p>
<div class="sourceCode" id="cb726"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb726-1" data-line-number="1">x3 &lt;-<span class="st"> &quot;a &lt;- 1; a + 1&quot;</span></a>
<a class="sourceLine" id="cb726-2" data-line-number="2">rlang<span class="op">::</span><span class="kw">parse_exprs</span>(x3)</a>
<a class="sourceLine" id="cb726-3" data-line-number="3"><span class="co">#&gt; [[1]]</span></a>
<a class="sourceLine" id="cb726-4" data-line-number="4"><span class="co">#&gt; a &lt;- 1</span></a>
<a class="sourceLine" id="cb726-5" data-line-number="5"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb726-6" data-line-number="6"><span class="co">#&gt; [[2]]</span></a>
<a class="sourceLine" id="cb726-7" data-line-number="7"><span class="co">#&gt; a + 1</span></a></code></pre></div>
<p>If you find yourself working with strings containing code very frequently, you should reconsider your process. Read Chapter <a href="quasiquotation.html#quasiquotation">19</a> and consider whether you can generate expressions using quasiquotation more safely.</p>
<div class="base">
<p>The base equivalent to <code>parse_exprs()</code> is <code>parse()</code>. It is a little harder to use because its specialised for parsing R code stored in files. You need to supply your string to the <code>text</code> argument and it returns an expression vector (Section <a href="expressions.html#expression-vectors">18.6.3</a>). I recommend turning the output into a list:</p>
<div class="sourceCode" id="cb727"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb727-1" data-line-number="1"><span class="kw">as.list</span>(<span class="kw">parse</span>(<span class="dt">text =</span> x1))</a>
<a class="sourceLine" id="cb727-2" data-line-number="2"><span class="co">#&gt; [[1]]</span></a>
<a class="sourceLine" id="cb727-3" data-line-number="3"><span class="co">#&gt; y &lt;- x + 10</span></a></code></pre></div>
</div>
<p>
</p>
<p>The inverse of parsing is <strong>deparsing</strong>: given an expression, you want the string that would generate it. This happens automatically when you print an expression, and you can get the string with <code>rlang::expr_text()</code>:</p>
<div class="sourceCode" id="cb728"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb728-1" data-line-number="1">z &lt;-<span class="st"> </span><span class="kw">expr</span>(y &lt;-<span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="dv">10</span>)</a>
<a class="sourceLine" id="cb728-2" data-line-number="2"><span class="kw">expr_text</span>(z)</a>
<a class="sourceLine" id="cb728-3" data-line-number="3"><span class="co">#&gt; [1] &quot;y &lt;- x + 10&quot;</span></a></code></pre></div>
<p>Parsing and deparsing are not perfectly symmetric because parsing generates an <em>abstract</em> syntax tree. This means we lose backticks around ordinary names, comments, and whitespace:</p>
<div class="sourceCode" id="cb729"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb729-1" data-line-number="1"><span class="kw">cat</span>(<span class="kw">expr_text</span>(<span class="kw">expr</span>({</a>
<a class="sourceLine" id="cb729-2" data-line-number="2">  <span class="co"># This is a comment</span></a>
<a class="sourceLine" id="cb729-3" data-line-number="3">  x &lt;-<span class="st">             `</span><span class="dt">x</span><span class="st">`</span> <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb729-4" data-line-number="4">})))</a>
<a class="sourceLine" id="cb729-5" data-line-number="5"><span class="co">#&gt; {</span></a>
<a class="sourceLine" id="cb729-6" data-line-number="6"><span class="co">#&gt;     x &lt;- x + 1</span></a>
<a class="sourceLine" id="cb729-7" data-line-number="7"><span class="co">#&gt; }</span></a></code></pre></div>
<div class="base">
<p>Be careful when using the base R equivalent, <code>deparse()</code>: it returns a character vector with one element for each line. Whenever you use it, remember that the length of the output might be greater than one, and plan accordingly.</p>
</div>
</div>
<div id="exercises-2" class="section level3">
<h3><span class="header-section-number">18.4.4</span> Exercises</h3>
<ol style="list-style-type: decimal">
<li><p>R uses parentheses in two slightly different ways as illustrated by
these two calls:</p>
<div class="sourceCode" id="cb730"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb730-1" data-line-number="1"><span class="kw">f</span>((<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb730-2" data-line-number="2"><span class="st">`</span><span class="dt">(</span><span class="st">`</span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)</a></code></pre></div>
<p>Compare and contrast the two uses by referencing the AST.</p></li>
<li><p><code>=</code> can also be used in two ways. Construct a simple example that shows
both uses.</p></li>
<li><p>Does <code>-2^2</code> yield 4 or -4? Why?</p></li>
<li><p>What does <code>!1 + !1</code> return? Why?</p></li>
<li><p>Why does <code>x1 &lt;- x2 &lt;- x3 &lt;- 0</code> work? Describe the two reasons.</p></li>
<li><p>Compare the ASTs of <code>x + y %+% z</code> and <code>x ^ y %+% z</code>. What have you learned
about the precedence of custom infix functions?</p></li>
<li><p>What happens if you call <code>parse_expr()</code> with a string that generates
multiple expressions? e.g. <code>parse_expr(&quot;x + 1; y + 1&quot;)</code></p></li>
<li><p>What happens if you attempt to parse an invalid expression? e.g. <code>&quot;a +&quot;</code>
or <code>&quot;f())&quot;</code>.</p></li>
<li><p><code>deparse()</code> produces vectors when the input is long. For example, the
following call produces a vector of length two:</p>
<div class="sourceCode" id="cb731"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb731-1" data-line-number="1">expr &lt;-<span class="st"> </span><span class="kw">expr</span>(<span class="kw">g</span>(a <span class="op">+</span><span class="st"> </span>b <span class="op">+</span><span class="st"> </span>c <span class="op">+</span><span class="st"> </span>d <span class="op">+</span><span class="st"> </span>e <span class="op">+</span><span class="st"> </span>f <span class="op">+</span><span class="st"> </span>g <span class="op">+</span><span class="st"> </span>h <span class="op">+</span><span class="st"> </span>i <span class="op">+</span><span class="st"> </span>j <span class="op">+</span><span class="st"> </span>k <span class="op">+</span><span class="st"> </span>l <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb731-2" data-line-number="2"><span class="st">  </span>m <span class="op">+</span><span class="st"> </span>n <span class="op">+</span><span class="st"> </span>o <span class="op">+</span><span class="st"> </span>p <span class="op">+</span><span class="st"> </span>q <span class="op">+</span><span class="st"> </span>r <span class="op">+</span><span class="st"> </span>s <span class="op">+</span><span class="st"> </span>t <span class="op">+</span><span class="st"> </span>u <span class="op">+</span><span class="st"> </span>v <span class="op">+</span><span class="st"> </span>w <span class="op">+</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>y <span class="op">+</span><span class="st"> </span>z))</a>
<a class="sourceLine" id="cb731-3" data-line-number="3"></a>
<a class="sourceLine" id="cb731-4" data-line-number="4"><span class="kw">deparse</span>(expr)</a></code></pre></div>
<p>What does <code>expr_text()</code> do instead?</p></li>
<li><p><code>pairwise.t.test()</code> assumes that <code>deparse()</code> always returns a length one
character vector. Can you construct an input that violates this expectation?
What happens?</p></li>
</ol>
</div>
</div>
<div id="ast-funs" class="section level2">
<h2><span class="header-section-number">18.5</span> Walking AST with recursive functions</h2>
<p>
</p>
<p>To conclude the chapter Im going to use everything youve learned about ASTs to solve more complicated problems. The inspiration comes from the base codetools package, which provides two interesting functions:</p>
<ul>
<li><p><code>findGlobals()</code> locates all global variables used by a function. This
can be useful if you want to check that your function doesnt inadvertently
rely on variables defined in their parent environment.</p></li>
<li><p><code>checkUsage()</code> checks for a range of common problems including
unused local variables, unused parameters, and the use of partial
argument matching.</p></li>
</ul>
<p>Getting all of the details of these functions correct is fiddly, so we wont fully develop the ideas. Instead well focus on the big underlying idea: recursion on the AST. Recursive functions are a natural fit to tree-like data structures because a recursive function is made up of two parts that correspond to the two parts of the tree:</p>
<ul>
<li><p>The <strong>recursive case</strong> handles the nodes in the tree. Typically, youll
do something to each child of a node, usually calling the recursive function
again, and then combine the results back together again. For expressions,
youll need to handle calls and pairlists (function arguments).</p></li>
<li><p>The <strong>base case</strong> handles the leaves of the tree. The base cases ensure
that the function eventually terminates, by solving the simplest cases
directly. For expressions, you need to handle symbols and constants in the
base case.</p></li>
</ul>
<p>To make this pattern easier to see, well need two helper functions. First we define <code>expr_type()</code> which will return constant for constant, symbol for symbols, call, for calls, pairlist for pairlists, and the type of anything else:</p>
<div class="sourceCode" id="cb732"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb732-1" data-line-number="1">expr_type &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb732-2" data-line-number="2">  <span class="cf">if</span> (rlang<span class="op">::</span><span class="kw">is_syntactic_literal</span>(x)) {</a>
<a class="sourceLine" id="cb732-3" data-line-number="3">    <span class="st">&quot;constant&quot;</span></a>
<a class="sourceLine" id="cb732-4" data-line-number="4">  } <span class="cf">else</span> <span class="cf">if</span> (<span class="kw">is.symbol</span>(x)) {</a>
<a class="sourceLine" id="cb732-5" data-line-number="5">    <span class="st">&quot;symbol&quot;</span></a>
<a class="sourceLine" id="cb732-6" data-line-number="6">  } <span class="cf">else</span> <span class="cf">if</span> (<span class="kw">is.call</span>(x)) {</a>
<a class="sourceLine" id="cb732-7" data-line-number="7">    <span class="st">&quot;call&quot;</span></a>
<a class="sourceLine" id="cb732-8" data-line-number="8">  } <span class="cf">else</span> <span class="cf">if</span> (<span class="kw">is.pairlist</span>(x)) {</a>
<a class="sourceLine" id="cb732-9" data-line-number="9">    <span class="st">&quot;pairlist&quot;</span></a>
<a class="sourceLine" id="cb732-10" data-line-number="10">  } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb732-11" data-line-number="11">    <span class="kw">typeof</span>(x)</a>
<a class="sourceLine" id="cb732-12" data-line-number="12">  }</a>
<a class="sourceLine" id="cb732-13" data-line-number="13">}</a>
<a class="sourceLine" id="cb732-14" data-line-number="14"></a>
<a class="sourceLine" id="cb732-15" data-line-number="15"><span class="kw">expr_type</span>(<span class="kw">expr</span>(<span class="st">&quot;a&quot;</span>))</a>
<a class="sourceLine" id="cb732-16" data-line-number="16"><span class="co">#&gt; [1] &quot;constant&quot;</span></a>
<a class="sourceLine" id="cb732-17" data-line-number="17"><span class="kw">expr_type</span>(<span class="kw">expr</span>(x))</a>
<a class="sourceLine" id="cb732-18" data-line-number="18"><span class="co">#&gt; [1] &quot;symbol&quot;</span></a>
<a class="sourceLine" id="cb732-19" data-line-number="19"><span class="kw">expr_type</span>(<span class="kw">expr</span>(<span class="kw">f</span>(<span class="dv">1</span>, <span class="dv">2</span>)))</a>
<a class="sourceLine" id="cb732-20" data-line-number="20"><span class="co">#&gt; [1] &quot;call&quot;</span></a></code></pre></div>
<p>Well couple this with a wrapper around the switch function:</p>
<div class="sourceCode" id="cb733"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb733-1" data-line-number="1">switch_expr &lt;-<span class="st"> </span><span class="cf">function</span>(x, ...) {</a>
<a class="sourceLine" id="cb733-2" data-line-number="2">  <span class="cf">switch</span>(<span class="kw">expr_type</span>(x),</a>
<a class="sourceLine" id="cb733-3" data-line-number="3">    ...,</a>
<a class="sourceLine" id="cb733-4" data-line-number="4">    <span class="kw">stop</span>(<span class="st">&quot;Don&#39;t know how to handle type &quot;</span>, <span class="kw">typeof</span>(x), <span class="dt">call. =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb733-5" data-line-number="5">  )</a>
<a class="sourceLine" id="cb733-6" data-line-number="6">}</a></code></pre></div>
<p>With these two functions in hand, we can write a basic template for any function that walks the AST using <code>switch()</code> (Section <a href="control-flow.html#switch">5.2.3</a>):</p>
<div class="sourceCode" id="cb734"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb734-1" data-line-number="1">recurse_call &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb734-2" data-line-number="2">  <span class="kw">switch_expr</span>(x,</a>
<a class="sourceLine" id="cb734-3" data-line-number="3">    <span class="co"># Base cases</span></a>
<a class="sourceLine" id="cb734-4" data-line-number="4">    <span class="dt">symbol =</span> ,</a>
<a class="sourceLine" id="cb734-5" data-line-number="5">    <span class="dt">constant =</span> ,</a>
<a class="sourceLine" id="cb734-6" data-line-number="6"></a>
<a class="sourceLine" id="cb734-7" data-line-number="7">    <span class="co"># Recursive cases</span></a>
<a class="sourceLine" id="cb734-8" data-line-number="8">    <span class="dt">call =</span> ,</a>
<a class="sourceLine" id="cb734-9" data-line-number="9">    <span class="dt">pairlist =</span></a>
<a class="sourceLine" id="cb734-10" data-line-number="10">  )</a>
<a class="sourceLine" id="cb734-11" data-line-number="11">}</a></code></pre></div>
<p>Typically, solving the base case is easy, so well do that first, then check the results. The recursive cases are trickier, and will often require some functional programming.</p>
<div id="finding-f-and-t" class="section level3">
<h3><span class="header-section-number">18.5.1</span> Finding F and T</h3>
<p>Well start with a function that determines whether another function uses the logical abbreviations <code>T</code> and <code>F</code> because using them is often considered to be poor coding practice. Our goal is to return <code>TRUE</code> if the input contains a logical abbreviation, and <code>FALSE</code> otherwise.</p>
<p>Lets first find the type of <code>T</code> versus <code>TRUE</code>:</p>
<div class="sourceCode" id="cb735"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb735-1" data-line-number="1"><span class="kw">expr_type</span>(<span class="kw">expr</span>(<span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb735-2" data-line-number="2"><span class="co">#&gt; [1] &quot;constant&quot;</span></a>
<a class="sourceLine" id="cb735-3" data-line-number="3"></a>
<a class="sourceLine" id="cb735-4" data-line-number="4"><span class="kw">expr_type</span>(<span class="kw">expr</span>(T))</a>
<a class="sourceLine" id="cb735-5" data-line-number="5"><span class="co">#&gt; [1] &quot;symbol&quot;</span></a></code></pre></div>
<p><code>TRUE</code> is parsed as a logical vector of length one, while <code>T</code> is parsed as a name. This tells us how to write our base cases for the recursive function: a constant is never a logical abbreviation, and a symbol is an abbreviation if its F or T:</p>
<div class="sourceCode" id="cb736"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb736-1" data-line-number="1">logical_abbr_rec &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb736-2" data-line-number="2">  <span class="kw">switch_expr</span>(x,</a>
<a class="sourceLine" id="cb736-3" data-line-number="3">    <span class="dt">constant =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb736-4" data-line-number="4">    <span class="dt">symbol =</span> <span class="kw">as_string</span>(x) <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;F&quot;</span>, <span class="st">&quot;T&quot;</span>)</a>
<a class="sourceLine" id="cb736-5" data-line-number="5">  )</a>
<a class="sourceLine" id="cb736-6" data-line-number="6">}</a>
<a class="sourceLine" id="cb736-7" data-line-number="7"></a>
<a class="sourceLine" id="cb736-8" data-line-number="8"><span class="kw">logical_abbr_rec</span>(<span class="kw">expr</span>(<span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb736-9" data-line-number="9"><span class="co">#&gt; [1] FALSE</span></a>
<a class="sourceLine" id="cb736-10" data-line-number="10"><span class="kw">logical_abbr_rec</span>(<span class="kw">expr</span>(T))</a>
<a class="sourceLine" id="cb736-11" data-line-number="11"><span class="co">#&gt; [1] TRUE</span></a></code></pre></div>
<p>Ive written <code>logical_abbr_rec()</code> function assuming that the input will be an expression as this will make the recursive operation simpler. However, when writing a recursive function its common to write a wrapper that provides defaults or makes the function a little easier to use. Here well typically make a wrapper that quotes its input (well learn more about that in the next chapter), so we dont need to use <code>expr()</code> every time.</p>
<div class="sourceCode" id="cb737"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb737-1" data-line-number="1">logical_abbr &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb737-2" data-line-number="2">  <span class="kw">logical_abbr_rec</span>(<span class="kw">enexpr</span>(x))</a>
<a class="sourceLine" id="cb737-3" data-line-number="3">}</a>
<a class="sourceLine" id="cb737-4" data-line-number="4"></a>
<a class="sourceLine" id="cb737-5" data-line-number="5"><span class="kw">logical_abbr</span>(T)</a>
<a class="sourceLine" id="cb737-6" data-line-number="6"><span class="co">#&gt; [1] TRUE</span></a>
<a class="sourceLine" id="cb737-7" data-line-number="7"><span class="kw">logical_abbr</span>(<span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb737-8" data-line-number="8"><span class="co">#&gt; [1] FALSE</span></a></code></pre></div>
<p>Next we need to implement the recursive cases. Here we want to do the same thing for calls and for pairlists: recursively apply the function to each subcomponent, and return <code>TRUE</code> if any subcomponent contains a logical abbreviation. This is made easy by <code>purrr::some()</code>, which iterates over a list and returns <code>TRUE</code> if the predicate function is true for any element.</p>
<div class="sourceCode" id="cb738"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb738-1" data-line-number="1">logical_abbr_rec &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb738-2" data-line-number="2">  <span class="kw">switch_expr</span>(x,</a>
<a class="sourceLine" id="cb738-3" data-line-number="3">    <span class="co"># Base cases</span></a>
<a class="sourceLine" id="cb738-4" data-line-number="4">    <span class="dt">constant =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb738-5" data-line-number="5">    <span class="dt">symbol =</span> <span class="kw">as_string</span>(x) <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;F&quot;</span>, <span class="st">&quot;T&quot;</span>),</a>
<a class="sourceLine" id="cb738-6" data-line-number="6"></a>
<a class="sourceLine" id="cb738-7" data-line-number="7">    <span class="co"># Recursive cases</span></a>
<a class="sourceLine" id="cb738-8" data-line-number="8">    <span class="dt">call =</span> ,</a>
<a class="sourceLine" id="cb738-9" data-line-number="9">    <span class="dt">pairlist =</span> purrr<span class="op">::</span><span class="kw">some</span>(x, logical_abbr_rec)</a>
<a class="sourceLine" id="cb738-10" data-line-number="10">  )</a>
<a class="sourceLine" id="cb738-11" data-line-number="11">}</a>
<a class="sourceLine" id="cb738-12" data-line-number="12"></a>
<a class="sourceLine" id="cb738-13" data-line-number="13"><span class="kw">logical_abbr</span>(<span class="kw">mean</span>(x, <span class="dt">na.rm =</span> T))</a>
<a class="sourceLine" id="cb738-14" data-line-number="14"><span class="co">#&gt; [1] TRUE</span></a>
<a class="sourceLine" id="cb738-15" data-line-number="15"><span class="kw">logical_abbr</span>(<span class="cf">function</span>(x, <span class="dt">na.rm =</span> T) <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb738-16" data-line-number="16"><span class="co">#&gt; [1] TRUE</span></a></code></pre></div>
</div>
<div id="finding-all-variables-created-by-assignment" class="section level3">
<h3><span class="header-section-number">18.5.2</span> Finding all variables created by assignment</h3>
<p><code>logical_abbr()</code> is relatively simple: it only returns a single <code>TRUE</code> or <code>FALSE</code>. The next task, listing all variables created by assignment, is a little more complicated. Well start simply, and then make the function progressively more rigorous. </p>
<p>We start by looking at the AST for assignment:</p>
<div class="sourceCode" id="cb739"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb739-1" data-line-number="1"><span class="kw">ast</span>(x &lt;-<span class="st"> </span><span class="dv">10</span>)</a>
<a class="sourceLine" id="cb739-2" data-line-number="2"><span class="co">#&gt; `&lt;-` </span></a>
<a class="sourceLine" id="cb739-3" data-line-number="3"><span class="co">#&gt; x </span></a>
<a class="sourceLine" id="cb739-4" data-line-number="4"><span class="co">#&gt; 10</span></a></code></pre></div>
<p>Assignment is a call object where the first element is the symbol <code>&lt;-</code>, the second is the name of variable, and the third is the value to be assigned.</p>
<p>Next, we need to decide what data structure were going to use for the results. Here I think it will be easiest if we return a character vector. If we return symbols, well need to use a <code>list()</code> and that makes things a little more complicated.</p>
<p>With that in hand we can start by implementing the base cases and providing a helpful wrapper around the recursive function. Here the base cases are straightforward because we know that neither a symbol nor a constant represents assignment.</p>
<div class="sourceCode" id="cb740"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb740-1" data-line-number="1">find_assign_rec &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb740-2" data-line-number="2">  <span class="kw">switch_expr</span>(x,</a>
<a class="sourceLine" id="cb740-3" data-line-number="3">    <span class="dt">constant =</span> ,</a>
<a class="sourceLine" id="cb740-4" data-line-number="4">    <span class="dt">symbol =</span> <span class="kw">character</span>()</a>
<a class="sourceLine" id="cb740-5" data-line-number="5">  )</a>
<a class="sourceLine" id="cb740-6" data-line-number="6">}</a>
<a class="sourceLine" id="cb740-7" data-line-number="7">find_assign &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">find_assign_rec</span>(<span class="kw">enexpr</span>(x))</a>
<a class="sourceLine" id="cb740-8" data-line-number="8"></a>
<a class="sourceLine" id="cb740-9" data-line-number="9"><span class="kw">find_assign</span>(<span class="st">&quot;x&quot;</span>)</a>
<a class="sourceLine" id="cb740-10" data-line-number="10"><span class="co">#&gt; character(0)</span></a>
<a class="sourceLine" id="cb740-11" data-line-number="11"><span class="kw">find_assign</span>(x)</a>
<a class="sourceLine" id="cb740-12" data-line-number="12"><span class="co">#&gt; character(0)</span></a></code></pre></div>
<p>Next we implement the recursive cases. This is made easier by a function that should exist in purrr, but currently doesnt. <code>flat_map_chr()</code> expects <code>.f</code> to return a character vector of arbitrary length, and flattens all results into a single character vector.</p>
<!-- GVW: by this point, will readers have seen the `.x` and `.f` conventions enough that they don't need explanation? -->
<div class="sourceCode" id="cb741"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb741-1" data-line-number="1">flat_map_chr &lt;-<span class="st"> </span><span class="cf">function</span>(.x, .f, ...) {</a>
<a class="sourceLine" id="cb741-2" data-line-number="2">  purrr<span class="op">::</span><span class="kw">flatten_chr</span>(purrr<span class="op">::</span><span class="kw">map</span>(.x, .f, ...))</a>
<a class="sourceLine" id="cb741-3" data-line-number="3">}</a>
<a class="sourceLine" id="cb741-4" data-line-number="4"></a>
<a class="sourceLine" id="cb741-5" data-line-number="5"><span class="kw">flat_map_chr</span>(letters[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>], <span class="op">~</span><span class="st"> </span><span class="kw">rep</span>(., <span class="kw">sample</span>(<span class="dv">3</span>, <span class="dv">1</span>)))</a>
<a class="sourceLine" id="cb741-6" data-line-number="6"><span class="co">#&gt; [1] &quot;a&quot; &quot;b&quot; &quot;b&quot; &quot;b&quot; &quot;c&quot; &quot;c&quot; &quot;c&quot;</span></a></code></pre></div>
<p>The recursive case for pairlists is straightforward: we iterate over every element of the pairlist (i.e.each function argument) and combine the results. The case for calls is a little bit more complex: if this is a call to <code>&lt;-</code> then we should return the second element of the call:</p>
<div class="sourceCode" id="cb742"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb742-1" data-line-number="1">find_assign_rec &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb742-2" data-line-number="2">  <span class="kw">switch_expr</span>(x,</a>
<a class="sourceLine" id="cb742-3" data-line-number="3">    <span class="co"># Base cases</span></a>
<a class="sourceLine" id="cb742-4" data-line-number="4">    <span class="dt">constant =</span> ,</a>
<a class="sourceLine" id="cb742-5" data-line-number="5">    <span class="dt">symbol =</span> <span class="kw">character</span>(),</a>
<a class="sourceLine" id="cb742-6" data-line-number="6"></a>
<a class="sourceLine" id="cb742-7" data-line-number="7">    <span class="co"># Recursive cases</span></a>
<a class="sourceLine" id="cb742-8" data-line-number="8">    <span class="dt">pairlist =</span> <span class="kw">flat_map_chr</span>(<span class="kw">as.list</span>(x), find_assign_rec),</a>
<a class="sourceLine" id="cb742-9" data-line-number="9">    <span class="dt">call =</span> {</a>
<a class="sourceLine" id="cb742-10" data-line-number="10">      <span class="cf">if</span> (<span class="kw">is_call</span>(x, <span class="st">&quot;&lt;-&quot;</span>)) {</a>
<a class="sourceLine" id="cb742-11" data-line-number="11">        <span class="kw">as_string</span>(x[[<span class="dv">2</span>]])</a>
<a class="sourceLine" id="cb742-12" data-line-number="12">      } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb742-13" data-line-number="13">        <span class="kw">flat_map_chr</span>(<span class="kw">as.list</span>(x), find_assign_rec)</a>
<a class="sourceLine" id="cb742-14" data-line-number="14">      }</a>
<a class="sourceLine" id="cb742-15" data-line-number="15">    }</a>
<a class="sourceLine" id="cb742-16" data-line-number="16">  )</a>
<a class="sourceLine" id="cb742-17" data-line-number="17">}</a>
<a class="sourceLine" id="cb742-18" data-line-number="18"></a>
<a class="sourceLine" id="cb742-19" data-line-number="19"><span class="kw">find_assign</span>(a &lt;-<span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb742-20" data-line-number="20"><span class="co">#&gt; [1] &quot;a&quot;</span></a>
<a class="sourceLine" id="cb742-21" data-line-number="21"><span class="kw">find_assign</span>({</a>
<a class="sourceLine" id="cb742-22" data-line-number="22">  a &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb742-23" data-line-number="23">  {</a>
<a class="sourceLine" id="cb742-24" data-line-number="24">    b &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb742-25" data-line-number="25">  }</a>
<a class="sourceLine" id="cb742-26" data-line-number="26">})</a>
<a class="sourceLine" id="cb742-27" data-line-number="27"><span class="co">#&gt; [1] &quot;a&quot; &quot;b&quot;</span></a></code></pre></div>
<p>Now we need to make our function more robust by coming up with examples intended to break it. What happens when we assign to the same variable multiple times?</p>
<div class="sourceCode" id="cb743"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb743-1" data-line-number="1"><span class="kw">find_assign</span>({</a>
<a class="sourceLine" id="cb743-2" data-line-number="2">  a &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb743-3" data-line-number="3">  a &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb743-4" data-line-number="4">})</a>
<a class="sourceLine" id="cb743-5" data-line-number="5"><span class="co">#&gt; [1] &quot;a&quot; &quot;a&quot;</span></a></code></pre></div>
<p>Its easiest to fix this at the level of the wrapper function:</p>
<div class="sourceCode" id="cb744"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb744-1" data-line-number="1">find_assign &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">unique</span>(<span class="kw">find_assign_rec</span>(<span class="kw">enexpr</span>(x)))</a>
<a class="sourceLine" id="cb744-2" data-line-number="2"></a>
<a class="sourceLine" id="cb744-3" data-line-number="3"><span class="kw">find_assign</span>({</a>
<a class="sourceLine" id="cb744-4" data-line-number="4">  a &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb744-5" data-line-number="5">  a &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb744-6" data-line-number="6">})</a>
<a class="sourceLine" id="cb744-7" data-line-number="7"><span class="co">#&gt; [1] &quot;a&quot;</span></a></code></pre></div>
<p>What happens if we have nested calls to <code>&lt;-</code>? Currently we only return the first. Thats because when <code>&lt;-</code> occurs we immediately terminate recursion.</p>
<div class="sourceCode" id="cb745"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb745-1" data-line-number="1"><span class="kw">find_assign</span>({</a>
<a class="sourceLine" id="cb745-2" data-line-number="2">  a &lt;-<span class="st"> </span>b &lt;-<span class="st"> </span>c &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb745-3" data-line-number="3">})</a>
<a class="sourceLine" id="cb745-4" data-line-number="4"><span class="co">#&gt; [1] &quot;a&quot;</span></a></code></pre></div>
<p>Instead we need to take a more rigorous approach. I think its best to keep the recursive function focused on the tree structure, so Im going to extract out <code>find_assign_call()</code> into a separate function.</p>
<div class="sourceCode" id="cb746"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb746-1" data-line-number="1">find_assign_call &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb746-2" data-line-number="2">  <span class="cf">if</span> (<span class="kw">is_call</span>(x, <span class="st">&quot;&lt;-&quot;</span>) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">is_symbol</span>(x[[<span class="dv">2</span>]])) {</a>
<a class="sourceLine" id="cb746-3" data-line-number="3">    lhs &lt;-<span class="st"> </span><span class="kw">as_string</span>(x[[<span class="dv">2</span>]])</a>
<a class="sourceLine" id="cb746-4" data-line-number="4">    children &lt;-<span class="st"> </span><span class="kw">as.list</span>(x)[<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb746-5" data-line-number="5">  } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb746-6" data-line-number="6">    lhs &lt;-<span class="st"> </span><span class="kw">character</span>()</a>
<a class="sourceLine" id="cb746-7" data-line-number="7">    children &lt;-<span class="st"> </span><span class="kw">as.list</span>(x)</a>
<a class="sourceLine" id="cb746-8" data-line-number="8">  }</a>
<a class="sourceLine" id="cb746-9" data-line-number="9"></a>
<a class="sourceLine" id="cb746-10" data-line-number="10">  <span class="kw">c</span>(lhs, <span class="kw">flat_map_chr</span>(children, find_assign_rec))</a>
<a class="sourceLine" id="cb746-11" data-line-number="11">}</a>
<a class="sourceLine" id="cb746-12" data-line-number="12"></a>
<a class="sourceLine" id="cb746-13" data-line-number="13">find_assign_rec &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb746-14" data-line-number="14">  <span class="kw">switch_expr</span>(x,</a>
<a class="sourceLine" id="cb746-15" data-line-number="15">    <span class="co"># Base cases</span></a>
<a class="sourceLine" id="cb746-16" data-line-number="16">    <span class="dt">constant =</span> ,</a>
<a class="sourceLine" id="cb746-17" data-line-number="17">    <span class="dt">symbol =</span> <span class="kw">character</span>(),</a>
<a class="sourceLine" id="cb746-18" data-line-number="18"></a>
<a class="sourceLine" id="cb746-19" data-line-number="19">    <span class="co"># Recursive cases</span></a>
<a class="sourceLine" id="cb746-20" data-line-number="20">    <span class="dt">pairlist =</span> <span class="kw">flat_map_chr</span>(x, find_assign_rec),</a>
<a class="sourceLine" id="cb746-21" data-line-number="21">    <span class="dt">call =</span> <span class="kw">find_assign_call</span>(x)</a>
<a class="sourceLine" id="cb746-22" data-line-number="22">  )</a>
<a class="sourceLine" id="cb746-23" data-line-number="23">}</a>
<a class="sourceLine" id="cb746-24" data-line-number="24"></a>
<a class="sourceLine" id="cb746-25" data-line-number="25"><span class="kw">find_assign</span>(a &lt;-<span class="st"> </span>b &lt;-<span class="st"> </span>c &lt;-<span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb746-26" data-line-number="26"><span class="co">#&gt; [1] &quot;a&quot; &quot;b&quot; &quot;c&quot;</span></a>
<a class="sourceLine" id="cb746-27" data-line-number="27"><span class="kw">find_assign</span>(<span class="kw">system.time</span>(x &lt;-<span class="st"> </span><span class="kw">print</span>(y &lt;-<span class="st"> </span><span class="dv">5</span>)))</a>
<a class="sourceLine" id="cb746-28" data-line-number="28"><span class="co">#&gt; [1] &quot;x&quot; &quot;y&quot;</span></a></code></pre></div>
<p>The complete version of this function is quite complicated, its important to remember we wrote it by working our way up by writing simple component parts.</p>
</div>
<div id="exercises-3" class="section level3">
<h3><span class="header-section-number">18.5.3</span> Exercises</h3>
<ol style="list-style-type: decimal">
<li><p><code>logical_abbr()</code> returns <code>TRUE</code> for <code>T(1, 2, 3)</code>. How could you modify
<code>logical_abbr_rec()</code> so that it ignores function calls that use <code>T</code> or <code>F</code>?</p></li>
<li><p><code>logical_abbr()</code> works with expressions. It currently fails when you give it
a function. Why? How could you modify <code>logical_abbr()</code> to make it
work? What components of a function will you need to recurse over?</p>
<div class="sourceCode" id="cb747"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb747-1" data-line-number="1"><span class="kw">logical_abbr</span>(<span class="cf">function</span>(<span class="dt">x =</span> <span class="ot">TRUE</span>) {</a>
<a class="sourceLine" id="cb747-2" data-line-number="2">  <span class="kw">g</span>(x <span class="op">+</span><span class="st"> </span>T)</a>
<a class="sourceLine" id="cb747-3" data-line-number="3">})</a></code></pre></div></li>
<li><p>Modify <code>find_assign</code> to also detect assignment using replacement
functions, i.e. <code>names(x) &lt;- y</code>.</p></li>
<li><p>Write a function that extracts all calls to a specified function.</p></li>
</ol>
</div>
</div>
<div id="expression-special" class="section level2">
<h2><span class="header-section-number">18.6</span> Specialised data structures</h2>
<p>There are two data structures and one special symbol that we need to cover for the sake of completeness. They are not usually important in practice.</p>
<div id="pairlists" class="section level3">
<h3><span class="header-section-number">18.6.1</span> Pairlists</h3>
<p></p>
<p>Pairlists are a remnant of Rs past and have been replaced by lists almost everywhere. The only place you are likely to see pairlists in R<a href="#fn66" class="footnote-ref" id="fnref66"><sup>66</sup></a> is when working with calls to the <code>function</code> function, as the formal arguments to a function are stored in a pairlist:</p>
<div class="sourceCode" id="cb748"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb748-1" data-line-number="1">f &lt;-<span class="st"> </span><span class="kw">expr</span>(<span class="cf">function</span>(x, <span class="dt">y =</span> <span class="dv">10</span>) x <span class="op">+</span><span class="st"> </span>y)</a>
<a class="sourceLine" id="cb748-2" data-line-number="2"></a>
<a class="sourceLine" id="cb748-3" data-line-number="3">args &lt;-<span class="st"> </span>f[[<span class="dv">2</span>]]</a>
<a class="sourceLine" id="cb748-4" data-line-number="4">args</a>
<a class="sourceLine" id="cb748-5" data-line-number="5"><span class="co">#&gt; $x</span></a>
<a class="sourceLine" id="cb748-6" data-line-number="6"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb748-7" data-line-number="7"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb748-8" data-line-number="8"><span class="co">#&gt; $y</span></a>
<a class="sourceLine" id="cb748-9" data-line-number="9"><span class="co">#&gt; [1] 10</span></a>
<a class="sourceLine" id="cb748-10" data-line-number="10"><span class="kw">typeof</span>(args)</a>
<a class="sourceLine" id="cb748-11" data-line-number="11"><span class="co">#&gt; [1] &quot;pairlist&quot;</span></a></code></pre></div>
<p>Fortunately, whenever you encounter a pairlist, you can treat it just like a regular list:</p>
<div class="sourceCode" id="cb749"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb749-1" data-line-number="1">pl &lt;-<span class="st"> </span><span class="kw">pairlist</span>(<span class="dt">x =</span> <span class="dv">1</span>, <span class="dt">y =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb749-2" data-line-number="2"><span class="kw">length</span>(pl)</a>
<a class="sourceLine" id="cb749-3" data-line-number="3"><span class="co">#&gt; [1] 2</span></a>
<a class="sourceLine" id="cb749-4" data-line-number="4">pl<span class="op">$</span>x</a>
<a class="sourceLine" id="cb749-5" data-line-number="5"><span class="co">#&gt; [1] 1</span></a></code></pre></div>
<p>Behind the scenes pairlists are implemented using a different data structure, a linked list instead of an array. That makes subsetting a pairlist much slower than subsetting a list, but this has little practical impact.</p>
</div>
<div id="empty-symbol" class="section level3">
<h3><span class="header-section-number">18.6.2</span> Missing arguments</h3>
<p>
</p>
<p>The special symbol that needs a little extra discussion is the empty symbol, which is used to represent missing arguments (not missing values!). You only need to care about the missing symbol if youre programmatically creating functions with missing arguments; well come back to that in Section <a href="quasiquotation.html#unquote-missing">19.4.3</a>.</p>
<p>You can make an empty symbol with <code>missing_arg()</code> (or <code>expr()</code>):</p>
<div class="sourceCode" id="cb750"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb750-1" data-line-number="1"><span class="kw">missing_arg</span>()</a>
<a class="sourceLine" id="cb750-2" data-line-number="2"><span class="kw">typeof</span>(<span class="kw">missing_arg</span>())</a>
<a class="sourceLine" id="cb750-3" data-line-number="3"><span class="co">#&gt; [1] &quot;symbol&quot;</span></a></code></pre></div>
<p>An empty symbol doesnt print anything, so you can check if you have one with <code>rlang::is_missing()</code>:</p>
<div class="sourceCode" id="cb751"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb751-1" data-line-number="1"><span class="kw">is_missing</span>(<span class="kw">missing_arg</span>())</a>
<a class="sourceLine" id="cb751-2" data-line-number="2"><span class="co">#&gt; [1] TRUE</span></a></code></pre></div>
<p>Youll find them in the wild in function formals:</p>
<div class="sourceCode" id="cb752"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb752-1" data-line-number="1">f &lt;-<span class="st"> </span><span class="kw">expr</span>(<span class="cf">function</span>(x, <span class="dt">y =</span> <span class="dv">10</span>) x <span class="op">+</span><span class="st"> </span>y)</a>
<a class="sourceLine" id="cb752-2" data-line-number="2">args &lt;-<span class="st"> </span>f[[<span class="dv">2</span>]]</a>
<a class="sourceLine" id="cb752-3" data-line-number="3"><span class="kw">is_missing</span>(args[[<span class="dv">1</span>]])</a>
<a class="sourceLine" id="cb752-4" data-line-number="4"><span class="co">#&gt; [1] TRUE</span></a></code></pre></div>
<p>This is particularly important for <code>...</code> which is always associated with an empty symbol:</p>
<div class="sourceCode" id="cb753"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb753-1" data-line-number="1">f &lt;-<span class="st"> </span><span class="kw">expr</span>(<span class="cf">function</span>(...) <span class="kw">list</span>(...))</a>
<a class="sourceLine" id="cb753-2" data-line-number="2">args &lt;-<span class="st"> </span>f[[<span class="dv">2</span>]]</a>
<a class="sourceLine" id="cb753-3" data-line-number="3"><span class="kw">is_missing</span>(args[[<span class="dv">1</span>]])</a>
<a class="sourceLine" id="cb753-4" data-line-number="4"><span class="co">#&gt; [1] TRUE</span></a></code></pre></div>
<p>The empty symbol has a peculiar property: if you bind it to a variable, then access that variable, you will get an error:</p>
<div class="sourceCode" id="cb754"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb754-1" data-line-number="1">m &lt;-<span class="st"> </span><span class="kw">missing_arg</span>()</a>
<a class="sourceLine" id="cb754-2" data-line-number="2">m</a>
<a class="sourceLine" id="cb754-3" data-line-number="3"><span class="co">#&gt; Error in eval(expr, envir, enclos): argument &quot;m&quot; is missing, with no default</span></a></code></pre></div>
<p>But you wont if you store it inside another data structure!</p>
<div class="sourceCode" id="cb755"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb755-1" data-line-number="1">ms &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="kw">missing_arg</span>(), <span class="kw">missing_arg</span>())</a>
<a class="sourceLine" id="cb755-2" data-line-number="2">ms[[<span class="dv">1</span>]]</a></code></pre></div>
<p>If you need to preserve the missingness of a variable, <code>rlang::maybe_missing()</code> is often helpful. It allows you to refer to a potentially missing variable without triggering the error. See the documentation for use cases and more details.</p>
</div>
<div id="expression-vectors" class="section level3">
<h3><span class="header-section-number">18.6.3</span> Expression vectors</h3>
<p>
</p>
<p>Finally, we need to briefly discuss the expression vector. Expression vectors are only produced by two base functions: <code>expression()</code> and <code>parse()</code>:</p>
<div class="sourceCode" id="cb756"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb756-1" data-line-number="1">exp1 &lt;-<span class="st"> </span><span class="kw">parse</span>(<span class="dt">text =</span> <span class="kw">c</span>(<span class="st">&quot;</span></a>
<a class="sourceLine" id="cb756-2" data-line-number="2"><span class="st">x &lt;- 4</span></a>
<a class="sourceLine" id="cb756-3" data-line-number="3"><span class="st">x</span></a>
<a class="sourceLine" id="cb756-4" data-line-number="4"><span class="st">&quot;</span>))</a>
<a class="sourceLine" id="cb756-5" data-line-number="5">exp2 &lt;-<span class="st"> </span><span class="kw">expression</span>(x &lt;-<span class="st"> </span><span class="dv">4</span>, x)</a>
<a class="sourceLine" id="cb756-6" data-line-number="6"></a>
<a class="sourceLine" id="cb756-7" data-line-number="7"><span class="kw">typeof</span>(exp1)</a>
<a class="sourceLine" id="cb756-8" data-line-number="8"><span class="co">#&gt; [1] &quot;expression&quot;</span></a>
<a class="sourceLine" id="cb756-9" data-line-number="9"><span class="kw">typeof</span>(exp2)</a>
<a class="sourceLine" id="cb756-10" data-line-number="10"><span class="co">#&gt; [1] &quot;expression&quot;</span></a>
<a class="sourceLine" id="cb756-11" data-line-number="11"></a>
<a class="sourceLine" id="cb756-12" data-line-number="12">exp1</a>
<a class="sourceLine" id="cb756-13" data-line-number="13"><span class="co">#&gt; expression(x &lt;- 4, x)</span></a>
<a class="sourceLine" id="cb756-14" data-line-number="14">exp2</a>
<a class="sourceLine" id="cb756-15" data-line-number="15"><span class="co">#&gt; expression(x &lt;- 4, x)</span></a></code></pre></div>
<p>Like calls and pairlists, expression vectors behave like lists:</p>
<div class="sourceCode" id="cb757"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb757-1" data-line-number="1"><span class="kw">length</span>(exp1)</a>
<a class="sourceLine" id="cb757-2" data-line-number="2"><span class="co">#&gt; [1] 2</span></a>
<a class="sourceLine" id="cb757-3" data-line-number="3">exp1[[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb757-4" data-line-number="4"><span class="co">#&gt; x &lt;- 4</span></a></code></pre></div>
<p>Conceptually, an expression vector is just a list of expressions. The only difference is that calling <code>eval()</code> on an expression evaluates each individual expression. I dont believe this advantage merits introducing a new data structure, so instead of expression vectors I just use lists of expressions.</p>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="59">
<li id="fn59"><p>For more complex code, you can also use RStudios tree viewer which doesnt obey quite the same graphical conventions, but allows you to interactively explore large ASTs. Try it out with <code>View(expr(f(x, &quot;y&quot;, 1)))</code>.<a href="expressions.html#fnref59" class="footnote-back"></a></p></li>
<li id="fn60"><p>The names of non-prefix functions are non-syntactic so I surround them with <code>``</code>, as in Section <a href="names-values.html#non-syntactic">2.2.1</a>.<a href="expressions.html#fnref60" class="footnote-back"></a></p></li>
<li id="fn61"><p>It is <em>possible</em> to insert any other base object into an expression, but this is unusual and only needed in rare circumstances. Well come back to that idea in Section <a href="quasiquotation.html#non-standard-ast">19.4.7</a>.<a href="expressions.html#fnref61" class="footnote-back"></a></p></li>
<li id="fn62"><p>More precisely, theyre pairlists, Section <a href="expressions.html#pairlists">18.6.1</a>, but this distinction rarely matters.<a href="expressions.html#fnref62" class="footnote-back"></a></p></li>
<li id="fn63"><p>Avoid <code>is.language()</code> which returns <code>TRUE</code> for symbols, calls, and expression vectors.<a href="expressions.html#fnref63" class="footnote-back"></a></p></li>
<li id="fn64"><p>Peculiarly, it can also be a number, as in the expression <code>3()</code>. But this call will always fail to evaluate because a number is not a function.<a href="expressions.html#fnref64" class="footnote-back"></a></p></li>
<li id="fn65"><p>This ambiguity does not exist in languages with only prefix or postfix calls. Its interesting to compare a simple arithmetic operation in Lisp (prefix) and Forth (postfix). In Lisp youd write <code>(* (+ 1 2) 3))</code>; this avoids ambiguity by requiring parentheses everywhere. In Forth, youd write <code>1 2 + 3 *</code>; this doesnt require any parentheses, but does require more thought when reading.<a href="expressions.html#fnref65" class="footnote-back"></a></p></li>
<li id="fn66"><p>If youre working in C, youll encounter pairlists more often. For example, call objects are also implemented using pairlists.<a href="expressions.html#fnref66" class="footnote-back"></a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="meta-big-picture.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="quasiquotation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/hadley/adv-r/edit/master/Expressions.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
